import{r as g,D as O,o,M as u,b as e,u as f,T as $,a as l,l as R,k as P,m as v,n as z,p as k,h as s,i as h,f as i,g as H,$ as D,v as N,a4 as W,as as X,U as Y,O as A,S as F,W as q,N as y,R as d,c as _,Y as V,a2 as G,X as J,a6 as C,a7 as S,a9 as K,a8 as T}from"./app-CqcLQhWc.js";import{_ as Q}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{l as Z}from"./lodash-CdjocJhF.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const ee={key:0},te={colspan:"7",class:"text-center py-10"},le={key:1},se={colspan:"7",class:"text-center py-10"},ae={class:"py-4"},re={class:"d-flex flex-column"},oe={class:"text-caption text-medium-emphasis text-truncate",style:{"max-width":"250px"}},ie={key:1,class:"text-medium-emphasis"},ne={class:"d-flex align-center gap-2"},ue={key:2,class:"text-caption text-medium-emphasis"},de={class:"text-right"},ce={class:"d-flex justify-end"},ye={__name:"Index",props:{tasks:Object,filters:Object},setup(n){const b=n,c=g(b.filters.search||""),m=g(b.filters.status||""),p=g(b.filters.priority||""),w=g(!1),B=[{title:"All Statuses",value:""},{title:"Pending",value:"pending"},{title:"In Progress",value:"in_progress"},{title:"Completed",value:"completed"}],L=[{title:"All Priorities",value:""},{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"}],j=()=>{w.value=!0,T.get(route("crm.tasks.index"),{search:c.value,status:m.value,priority:p.value},{preserveState:!0,replace:!0,onFinish:()=>w.value=!1})},U=()=>{c.value="",m.value="",p.value="",j()},E=r=>{confirm("Are you sure you want to delete this task?")&&T.delete(route("crm.tasks.destroy",r))},I=r=>{switch(r){case"pending":return"warning";case"in_progress":return"info";case"completed":return"success";default:return"grey"}},M=r=>{switch(r){case"low":return"success";case"medium":return"warning";case"high":return"error";default:return"grey"}};return O([c,m,p],Z.debounce(()=>{j()},500)),(r,a)=>(o(),u(F,null,[e(f($),{title:"Tasks"}),e(Q,null,{default:l(()=>[e(R,{fluid:""},{default:l(()=>[e(P,null,{default:l(()=>[e(v,{cols:"12"},{default:l(()=>[e(z,{elevation:"0",class:"mb-6"},{default:l(()=>[e(k,{class:"d-flex align-center justify-space-between py-4"},{default:l(()=>[a[6]||(a[6]=s("div",null,[s("h1",{class:"text-h4 mb-1"},"Tasks"),s("p",{class:"text-subtitle-1 text-medium-emphasis"},"Manage your tasks and to-do list.")],-1)),e(h,{color:"primary","prepend-icon":"mdi-plus",to:r.route("crm.tasks.create")},{default:l(()=>[...a[5]||(a[5]=[i(" New Task ",-1)])]),_:1},8,["to"])]),_:1})]),_:1}),e(z,{elevation:"0"},{default:l(()=>[e(k,{class:"pa-4"},{default:l(()=>[e(P,null,{default:l(()=>[e(v,{cols:"12",sm:"4"},{default:l(()=>[e(H,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value=t),"prepend-inner-icon":"mdi-magnify",label:"Search tasks...",variant:"outlined",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"3"},{default:l(()=>[e(D,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=t=>m.value=t),items:B,label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"3"},{default:l(()=>[e(D,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=t=>p.value=t),items:L,label:"Priority",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"2",class:"d-flex align-center"},{default:l(()=>[e(h,{variant:"text",color:"primary",onClick:U,block:""},{default:l(()=>[...a[7]||(a[7]=[i(" Clear ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(N),e(W,{hover:""},{default:l(()=>[a[12]||(a[12]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Task Title"),s("th",{class:"text-left"},"Project"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"Priority / Score"),s("th",{class:"text-left"},"SLA Status"),s("th",{class:"text-left"},"Due Date"),s("th",{class:"text-right"},"Actions")])],-1)),s("tbody",null,[w.value?(o(),u("tr",ee,[s("td",te,[e(X,{indeterminate:"",color:"primary"})])])):n.tasks.data.length===0?(o(),u("tr",le,[s("td",se,[e(Y,{size:"64",color:"medium-emphasis",class:"mb-4"},{default:l(()=>[...a[8]||(a[8]=[i("mdi-clipboard-text-outline",-1)])]),_:1}),a[9]||(a[9]=s("p",{class:"text-h6 text-medium-emphasis"},"No tasks found.",-1))])])):A("",!0),(o(!0),u(F,null,q(n.tasks.data,t=>(o(),u("tr",{key:t.id},[s("td",ae,[s("div",re,[e(f(y),{href:r.route("crm.tasks.show",t.id),class:"text-subtitle-1 font-weight-bold text-decoration-none text-primary"},{default:l(()=>[i(d(t.title),1)]),_:2},1032,["href"]),s("span",oe,d(t.description),1)])]),s("td",null,[t.project?(o(),_(f(y),{key:0,href:r.route("crm.projects.show",t.project.id),class:"text-body-2 text-decoration-none text-secondary"},{default:l(()=>[i(d(t.project.name),1)]),_:2},1032,["href"])):(o(),u("span",ie,"No Project"))]),s("td",null,[e(V,{color:I(t.status),size:"x-small",label:"",class:"text-uppercase font-weight-bold"},{default:l(()=>[i(d(t.status.replace("_"," ")),1)]),_:2},1032,["color"])]),s("td",null,[s("div",ne,[e(V,{color:M(t.priority),size:"x-small",variant:"outlined",class:"text-uppercase font-weight-bold"},{default:l(()=>[i(d(t.priority),1)]),_:2},1032,["color"]),e(G,{size:"24",color:t.priority_score>70?"error":"warning",class:"text-white text-caption"},{default:l(()=>[i(d(t.priority_score),1)]),_:2},1032,["color"])])]),s("td",null,[t.escalated_at?(o(),_(V,{key:0,color:"error",size:"x-small","prepend-icon":"mdi-alert-octagon",class:"text-uppercase font-weight-bold"},{default:l(()=>[...a[10]||(a[10]=[i(" Escalated ",-1)])]),_:1})):t.sla_minutes?(o(),_(V,{key:1,color:"success",size:"x-small",variant:"tonal",class:"text-uppercase font-weight-bold"},{default:l(()=>[...a[11]||(a[11]=[i(" In SLA ",-1)])]),_:1})):(o(),u("span",ue,"N/A"))]),s("td",null,[s("span",{class:J({"text-error":t.due_date&&new Date(t.due_date)<new Date})},d(t.due_date?new Date(t.due_date).toLocaleDateString():"No date"),3)]),s("td",de,[s("div",ce,[e(C,{text:"View Task"},{activator:l(({props:x})=>[e(f(y),{href:r.route("crm.tasks.show",t.id)},{default:l(()=>[e(h,S({icon:"mdi-eye",variant:"text",size:"small"},{ref_for:!0},x),null,16)]),_:2},1032,["href"])]),_:2},1024),e(C,{text:"Edit Task"},{activator:l(({props:x})=>[e(f(y),{href:r.route("crm.tasks.edit",t.id)},{default:l(()=>[e(h,S({icon:"mdi-pencil",variant:"text",size:"small"},{ref_for:!0},x),null,16)]),_:2},1032,["href"])]),_:2},1024),e(C,{text:"Delete Task"},{activator:l(({props:x})=>[e(h,S({icon:"mdi-delete",variant:"text",size:"small",color:"error"},{ref_for:!0},x,{onClick:me=>E(t.id)}),null,16,["onClick"])]),_:2},1024)])])]))),128))])]),_:1}),e(N),n.tasks.links.length>3?(o(),_(k,{key:0,class:"pa-4 d-flex justify-center"},{default:l(()=>[e(K,{modelValue:n.tasks.current_page,"onUpdate:modelValue":[a[3]||(a[3]=t=>n.tasks.current_page=t),a[4]||(a[4]=t=>f(T).get(r.route("crm.tasks.index"),{page:t,search:c.value,status:m.value,priority:p.value},{preserveState:!0,preserveScroll:!0,replace:!0}))],length:n.tasks.last_page,"total-visible":"7",rounded:"circle"},null,8,["modelValue","length"])]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{ye as default};
