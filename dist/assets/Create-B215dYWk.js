import{L as N,o as V,M as y,b as e,u as o,T as $,a as r,l as F,k as b,m as i,n as I,p as S,i as m,h as s,v as _,V as A,w as B,g as u,$ as g,f as w,a4 as M,S as h,W as O,R as c,a1 as z,ac as P,ad as L,F as x}from"./app-CqcLQhWc.js";import{_ as R}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const E={class:"mt-8 mb-4 d-flex align-center justify-space-between"},Q={class:"py-2"},W={class:"py-2"},G={class:"py-2"},H={class:"py-2 font-weight-bold"},J={class:"py-2 text-right"},K={class:"d-flex justify-space-between mb-2"},X={class:"font-weight-bold"},Y={class:"d-flex justify-space-between mb-2"},Z={class:"font-weight-bold"},ee={class:"d-flex justify-space-between text-h6 primary--text"},te={class:"font-weight-bold"},ne={__name:"Create",props:{clients:Array,projects:Array,nextInvoiceNumber:String},setup(f){const l=N({invoice_number:f.nextInvoiceNumber,client_id:null,project_id:null,issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],status:"draft",notes:"",items:[{description:"",quantity:1,unit_price:0}]}),q=[{title:"Draft",value:"draft"},{title:"Sent",value:"sent"},{title:"Paid",value:"paid"},{title:"Overdue",value:"overdue"},{title:"Cancelled",value:"cancelled"}],j=()=>{l.items.push({description:"",quantity:1,unit_price:0})},k=n=>{l.items.length>1&&l.items.splice(n,1)},v=x(()=>l.items.reduce((n,t)=>n+t.quantity*t.unit_price,0)),C=x(()=>v.value*.1),T=x(()=>v.value+C.value),p=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),D=()=>{l.post(route("crm.invoices.store"))};return(n,t)=>(V(),y(h,null,[e(o($),{title:"Create Invoice"}),e(R,null,{default:r(()=>[e(F,{fluid:""},{default:r(()=>[e(b,{justify:"center"},{default:r(()=>[e(i,{cols:"12",lg:"10"},{default:r(()=>[e(I,{elevation:"0"},{default:r(()=>[e(S,{class:"d-flex align-center py-4"},{default:r(()=>[e(m,{icon:"mdi-arrow-left",variant:"text",class:"mr-2",onClick:t[0]||(t[0]=a=>n.$window.history.back())}),t[9]||(t[9]=s("div",null,[s("h1",{class:"text-h5 mb-0"},"Create New Invoice")],-1))]),_:1}),e(_),e(A,{onSubmit:B(D,["prevent"])},{default:r(()=>[e(S,{class:"pa-6"},{default:r(()=>[e(b,null,{default:r(()=>[e(i,{cols:"12",md:"4"},{default:r(()=>[e(u,{modelValue:o(l).invoice_number,"onUpdate:modelValue":t[1]||(t[1]=a=>o(l).invoice_number=a),label:"Invoice Number",variant:"outlined","error-messages":o(l).errors.invoice_number,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",md:"4"},{default:r(()=>[e(g,{modelValue:o(l).client_id,"onUpdate:modelValue":t[2]||(t[2]=a=>o(l).client_id=a),items:f.clients,"item-title":"name","item-value":"id",label:"Client",variant:"outlined","error-messages":o(l).errors.client_id,required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(i,{cols:"12",md:"4"},{default:r(()=>[e(g,{modelValue:o(l).project_id,"onUpdate:modelValue":t[3]||(t[3]=a=>o(l).project_id=a),items:f.projects,"item-title":"name","item-value":"id",label:"Project (Optional)",variant:"outlined",clearable:"","error-messages":o(l).errors.project_id},null,8,["modelValue","items","error-messages"])]),_:1}),e(i,{cols:"12",md:"4"},{default:r(()=>[e(u,{modelValue:o(l).issue_date,"onUpdate:modelValue":t[4]||(t[4]=a=>o(l).issue_date=a),label:"Issue Date",type:"date",variant:"outlined","error-messages":o(l).errors.issue_date,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",md:"4"},{default:r(()=>[e(u,{modelValue:o(l).due_date,"onUpdate:modelValue":t[5]||(t[5]=a=>o(l).due_date=a),label:"Due Date",type:"date",variant:"outlined","error-messages":o(l).errors.due_date,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12",md:"4"},{default:r(()=>[e(g,{modelValue:o(l).status,"onUpdate:modelValue":t[6]||(t[6]=a=>o(l).status=a),items:q,label:"Status",variant:"outlined","error-messages":o(l).errors.status,required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),s("div",E,[t[11]||(t[11]=s("h3",{class:"text-h6"},"Invoice Items",-1)),e(m,{color:"secondary",variant:"outlined","prepend-icon":"mdi-plus",size:"small",onClick:j},{default:r(()=>[...t[10]||(t[10]=[w(" Add Item ",-1)])]),_:1})]),e(M,{class:"mb-6 border rounded"},{default:r(()=>[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",{class:"text-left",style:{width:"50%"}},"Description"),s("th",{class:"text-left",style:{width:"15%"}},"Quantity"),s("th",{class:"text-left",style:{width:"15%"}},"Unit Price"),s("th",{class:"text-left",style:{width:"15%"}},"Total"),s("th",{class:"text-right",style:{width:"5%"}})])],-1)),s("tbody",null,[(V(!0),y(h,null,O(o(l).items,(a,U)=>(V(),y("tr",{key:U},[s("td",Q,[e(u,{modelValue:a.description,"onUpdate:modelValue":d=>a.description=d,variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",W,[e(u,{modelValue:a.quantity,"onUpdate:modelValue":d=>a.quantity=d,modelModifiers:{number:!0},type:"number",variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",G,[e(u,{modelValue:a.unit_price,"onUpdate:modelValue":d=>a.unit_price=d,modelModifiers:{number:!0},type:"number",variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",H,c(p(a.quantity*a.unit_price)),1),s("td",J,[e(m,{icon:"mdi-delete",variant:"text",color:"error",size:"small",onClick:d=>k(U),disabled:o(l).items.length<=1},null,8,["onClick","disabled"])])]))),128))])]),_:1}),e(b,null,{default:r(()=>[e(i,{cols:"12",md:"7"},{default:r(()=>[e(z,{modelValue:o(l).notes,"onUpdate:modelValue":t[7]||(t[7]=a=>o(l).notes=a),label:"Notes",variant:"outlined",rows:"4",placeholder:"Thank you for your business!"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"5"},{default:r(()=>[e(I,{variant:"outlined",class:"pa-4 bg-grey-lighten-4"},{default:r(()=>[s("div",K,[t[13]||(t[13]=s("span",null,"Subtotal:",-1)),s("span",X,c(p(v.value)),1)]),s("div",Y,[t[14]||(t[14]=s("span",null,"Tax (10%):",-1)),s("span",Z,c(p(C.value)),1)]),e(_,{class:"my-2"}),s("div",ee,[t[15]||(t[15]=s("span",null,"Total:",-1)),s("span",te,c(p(T.value)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(_),e(P,{class:"pa-6"},{default:r(()=>[e(L),e(m,{variant:"text",onClick:t[8]||(t[8]=a=>n.$window.history.back()),class:"mr-2"},{default:r(()=>[...t[16]||(t[16]=[w(" Cancel ",-1)])]),_:1}),e(m,{color:"primary",type:"submit",size:"large",loading:o(l).processing},{default:r(()=>[...t[17]||(t[17]=[w(" Create Invoice ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{ne as default};
