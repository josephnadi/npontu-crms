import{r as v,D as P,a8 as h,o as d,M as C,b as e,u as m,T as I,a as t,k as D,m as _,h as s,N as V,i as u,f as o,n as j,p as F,g as O,$ as M,c as T,am as R,O as A,a4 as W,S as L,W as Y,R as r,Y as q,a6 as b,a7 as y,U as w,v as G,a9 as H,aa as J,ab as K,ac as Q,ad as X}from"./app-CqcLQhWc.js";import{_ as Z}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{l as ee}from"./lodash-CdjocJhF.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const te={class:"text-caption text-medium-emphasis"},le={key:1,class:"text-medium-emphasis"},ae={class:"text-right"},se={class:"d-flex justify-end gap-1"},oe={key:0},ie={class:"pa-4 d-flex justify-center"},me={__name:"Index",props:{contacts:Object,filters:Object,clients:Array},setup(f){const N=f,p=v(N.filters.search||""),g=v(N.filters.client_id||""),k=v(!1),x=v(!1),z=v(!1),c=v(null);P([p,g],ee.debounce(()=>{k.value=!0,h.get(route("crm.contacts.index"),{search:p.value,client_id:g.value},{preserveState:!0,replace:!0,preserveScroll:!0,onStart:()=>k.value=!0,onFinish:()=>k.value=!1})},500));const $=i=>{confirm("Are you sure you want to delete this contact?")&&h.delete(route("crm.contacts.destroy",i))},B=i=>{c.value=i,x.value=!0},U=()=>{c.value&&(z.value=!0,h.post(route("crm.contacts.convert",c.value.id),{},{onFinish:()=>{z.value=!1,x.value=!1,c.value=null}}))},E=i=>{confirm("Create a support ticket for this contact?")&&h.post(route("crm.contacts.convert-to-ticket",i))};return(i,l)=>(d(),C(L,null,[e(m(I),{title:"Contacts"}),e(Z,null,{default:t(()=>[e(D,null,{default:t(()=>[e(_,{cols:"12",class:"d-flex justify-space-between align-center mb-4"},{default:t(()=>[l[7]||(l[7]=s("div",null,[s("h2",{class:"text-h3 font-weight-bold"},"Contacts"),s("p",{class:"text-subtitle-1 text-medium-emphasis"},"Manage your customer relationships")],-1)),e(m(V),{href:i.route("crm.contacts.create")},{default:t(()=>[e(u,{color:"primary","prepend-icon":"mdi-plus"},{default:t(()=>[...l[6]||(l[6]=[o("Add Contact",-1)])]),_:1})]),_:1},8,["href"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(j,{elevation:"0",border:""},{default:t(()=>[e(F,{class:"pa-4"},{default:t(()=>[e(D,null,{default:t(()=>[e(_,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=a=>p.value=a),"prepend-inner-icon":"mdi-magnify",label:"Search contacts...",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"3"},{default:t(()=>[e(M,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=a=>g.value=a),items:f.clients,"item-title":"name","item-value":"id",label:"Filter by Client",variant:"outlined",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),k.value?(d(),T(R,{key:0,indeterminate:"",color:"primary",height:"2"})):A("",!0),e(W,null,{default:t(()=>[l[14]||(l[14]=s("thead",null,[s("tr",null,[s("th",{class:"text-left font-weight-bold"},"Contact Name"),s("th",{class:"text-left font-weight-bold"},"Client / Company"),s("th",{class:"text-left font-weight-bold"},"Email"),s("th",{class:"text-left font-weight-bold"},"Phone"),s("th",{class:"text-left font-weight-bold"},"Status"),s("th",{class:"text-right font-weight-bold"},"Actions")])],-1)),s("tbody",null,[(d(!0),C(L,null,Y(f.contacts.data,a=>(d(),C("tr",{key:a.id},[s("td",null,[e(m(V),{href:i.route("crm.contacts.show",a.id),class:"text-decoration-none font-weight-bold text-primary"},{default:t(()=>[o(r(a.first_name)+" "+r(a.last_name),1)]),_:2},1032,["href"]),s("div",te,r(a.job_title||"N/A"),1)]),s("td",null,[a.client?(d(),T(m(V),{key:0,href:i.route("crm.clients.show",a.client.id),class:"text-decoration-none"},{default:t(()=>[o(r(a.client.name),1)]),_:2},1032,["href"])):(d(),C("span",le,"N/A"))]),s("td",null,r(a.email||"N/A"),1),s("td",null,r(a.phone||"N/A"),1),s("td",null,[e(q,{color:a.status==="active"?"success":"grey",size:"x-small",variant:"flat",class:"text-capitalize"},{default:t(()=>[o(r(a.status),1)]),_:2},1032,["color"])]),s("td",ae,[s("div",se,[e(m(V),{href:i.route("crm.contacts.show",a.id),class:"text-decoration-none"},{default:t(()=>[e(b,{text:"View Details"},{activator:t(({props:n})=>[e(u,y({size:"x-small",icon:"",color:"info"},{ref_for:!0},n),{default:t(()=>[e(w,{size:"small"},{default:t(()=>[...l[8]||(l[8]=[o("mdi-eye",-1)])]),_:1})]),_:1},16)]),_:1})]),_:1},8,["href"]),e(m(V),{href:i.route("crm.contacts.edit",a.id),class:"text-decoration-none"},{default:t(()=>[e(b,{text:"Edit"},{activator:t(({props:n})=>[e(u,y({size:"x-small",icon:"",color:"primary"},{ref_for:!0},n),{default:t(()=>[e(w,{size:"small"},{default:t(()=>[...l[9]||(l[9]=[o("mdi-pencil",-1)])]),_:1})]),_:1},16)]),_:1})]),_:1},8,["href"]),e(b,{text:"Convert to Lead"},{activator:t(({props:n})=>[e(u,y({size:"x-small",icon:"",color:"warning",onClick:S=>B(a)},{ref_for:!0},n),{default:t(()=>[e(w,{size:"small"},{default:t(()=>[...l[10]||(l[10]=[o("mdi-account-convert-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),e(b,{text:"Convert to Ticket"},{activator:t(({props:n})=>[e(u,y({size:"x-small",icon:"",color:"info",onClick:S=>E(a.id)},{ref_for:!0},n),{default:t(()=>[e(w,{size:"small"},{default:t(()=>[...l[11]||(l[11]=[o("mdi-ticket-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),e(b,{text:"Delete"},{activator:t(({props:n})=>[e(u,y({size:"x-small",icon:"",color:"error",onClick:S=>$(a.id)},{ref_for:!0},n),{default:t(()=>[e(w,{size:"small"},{default:t(()=>[...l[12]||(l[12]=[o("mdi-delete",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024)])])]))),128)),f.contacts.data.length===0?(d(),C("tr",oe,[...l[13]||(l[13]=[s("td",{colspan:"6",class:"text-center py-8 text-medium-emphasis"},' No contacts found. Click "Add Contact" to get started. ',-1)])])):A("",!0)])]),_:1}),e(G),s("div",ie,[e(H,{modelValue:f.contacts.current_page,"onUpdate:modelValue":[l[2]||(l[2]=a=>f.contacts.current_page=a),l[3]||(l[3]=a=>m(h).get(i.route("crm.contacts.index"),{page:a,search:p.value,client_id:g.value},{preserveState:!0}))],length:f.contacts.last_page,size:"small"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1}),e(J,{modelValue:x.value,"onUpdate:modelValue":l[5]||(l[5]=a=>x.value=a),"max-width":"500px"},{default:t(()=>[c.value?(d(),T(j,{key:0},{default:t(()=>[e(K,{class:"pa-4 bg-warning text-white"},{default:t(()=>[o(" Convert "+r(c.value.first_name)+" "+r(c.value.last_name)+" to Lead? ",1)]),_:1}),e(F,{class:"pa-4 pt-6"},{default:t(()=>[...l[15]||(l[15]=[o(" This will archive the contact and create a new lead from its information. Activities and engagements will be migrated to the new lead. ",-1)])]),_:1}),e(Q,{class:"pa-4"},{default:t(()=>[e(X),e(u,{variant:"text",onClick:l[4]||(l[4]=a=>x.value=!1)},{default:t(()=>[...l[16]||(l[16]=[o("Cancel",-1)])]),_:1}),e(u,{color:"warning",variant:"elevated",loading:z.value,onClick:U},{default:t(()=>[...l[17]||(l[17]=[o(" Confirm Conversion ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):A("",!0)]),_:1},8,["modelValue"])]),_:1})],64))}};export{me as default};
