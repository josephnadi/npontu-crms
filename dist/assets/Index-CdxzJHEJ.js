import{r as h,D as E,o as n,M as p,b as e,u as k,T as R,a as t,l as q,k as T,m as v,n as D,p as L,h as s,i as _,f as r,g as H,$ as P,v as N,a4 as W,as as Y,U as f,O as Z,S as j,W as G,R as i,N as F,c as J,Y as w,aj as K,q as Q,s as g,Z as x,a7 as X,a9 as ee,a8 as y}from"./app-CqcLQhWc.js";import{_ as te}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{l as le}from"./lodash-CdjocJhF.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const se={key:0},ae={colspan:"8",class:"text-center py-10"},re={key:1},oe={colspan:"8",class:"text-center py-10"},ie={class:"text-subtitle-2 font-weight-bold"},ne={class:"py-4"},ue={class:"d-flex flex-column"},de={class:"text-caption text-medium-emphasis text-truncate",style:{"max-width":"250px"}},ce={key:1,class:"text-medium-emphasis"},me={class:"text-body-2"},pe={class:"text-right"},fe={class:"pa-4 d-flex justify-center"},he={__name:"Index",props:{tickets:Object,filters:Object},setup(u){const C=u,d=h(C.filters?.search||""),c=h(C.filters?.status||""),m=h(C.filters?.priority||""),V=h(!1),z=[{title:"All Statuses",value:""},{title:"Open",value:"open"},{title:"In Progress",value:"in_progress"},{title:"Pending",value:"pending"},{title:"Resolved",value:"resolved"},{title:"Closed",value:"closed"}],A=[{title:"All Priorities",value:""},{title:"Low",value:"low"},{title:"Medium",value:"medium"},{title:"High",value:"high"},{title:"Urgent",value:"urgent"}],S=()=>{V.value=!0,y.get(route("crm.tickets.index"),{search:d.value,status:c.value,priority:m.value},{preserveState:!0,replace:!0,preserveScroll:!0,onStart:()=>V.value=!0,onFinish:()=>V.value=!1})},U=()=>{d.value="",c.value="",m.value="",S()},B=o=>{confirm("Are you sure you want to delete this ticket?")&&y.delete(route("crm.tickets.destroy",o))},I=o=>{confirm("Convert this ticket to a Lead?")&&y.post(route("crm.tickets.convert-to-lead",o))},$=o=>{confirm("Convert this ticket to a Deal?")&&y.post(route("crm.tickets.convert-to-deal",o))},M=o=>{switch(o){case"open":return"primary";case"in_progress":return"info";case"pending":return"warning";case"resolved":return"success";case"closed":return"grey";default:return"grey"}},O=o=>{switch(o){case"low":return"success";case"medium":return"warning";case"high":return"error";case"urgent":return"deep-orange";default:return"grey"}};return E([d,c,m],le.debounce(()=>{S()},500)),(o,l)=>(n(),p(j,null,[e(k(R),{title:"Support Tickets"}),e(te,null,{default:t(()=>[e(q,{fluid:""},{default:t(()=>[e(T,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(D,{elevation:"0",class:"mb-6"},{default:t(()=>[e(L,{class:"d-flex align-center justify-space-between py-4"},{default:t(()=>[l[6]||(l[6]=s("div",null,[s("h1",{class:"text-h4 mb-1"},"Support Tickets"),s("p",{class:"text-subtitle-1 text-medium-emphasis"},"Manage customer support requests and issues.")],-1)),e(_,{color:"primary","prepend-icon":"mdi-plus",to:o.route("crm.tickets.create")},{default:t(()=>[...l[5]||(l[5]=[r(" New Ticket ",-1)])]),_:1},8,["to"])]),_:1})]),_:1}),e(D,{elevation:"0"},{default:t(()=>[e(L,{class:"pa-4"},{default:t(()=>[e(T,null,{default:t(()=>[e(v,{cols:"12",sm:"4"},{default:t(()=>[e(H,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=a=>d.value=a),"prepend-inner-icon":"mdi-magnify",label:"Search tickets...",variant:"outlined",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"3"},{default:t(()=>[e(P,{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=a=>c.value=a),items:z,label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"3"},{default:t(()=>[e(P,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=a=>m.value=a),items:A,label:"Priority",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",sm:"2",class:"d-flex align-center"},{default:t(()=>[e(_,{variant:"text",color:"primary",onClick:U,block:""},{default:t(()=>[...l[7]||(l[7]=[r(" Clear ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(N),e(W,{hover:""},{default:t(()=>[l[20]||(l[20]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Ticket #"),s("th",{class:"text-left"},"Subject"),s("th",{class:"text-left"},"Client"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"Priority"),s("th",{class:"text-left"},"Category"),s("th",{class:"text-left"},"Created At"),s("th",{class:"text-right"},"Actions")])],-1)),s("tbody",null,[V.value?(n(),p("tr",se,[s("td",ae,[e(Y,{indeterminate:"",color:"primary"})])])):u.tickets.data.length===0?(n(),p("tr",re,[s("td",oe,[e(f,{size:"64",color:"medium-emphasis",class:"mb-4"},{default:t(()=>[...l[8]||(l[8]=[r("mdi-ticket-outline",-1)])]),_:1}),l[9]||(l[9]=s("p",{class:"text-h6 text-medium-emphasis"},"No tickets found.",-1))])])):Z("",!0),(n(!0),p(j,null,G(u.tickets.data,a=>(n(),p("tr",{key:a.id},[s("td",null,[s("span",ie,i(a.ticket_number),1)]),s("td",ne,[s("div",ue,[e(k(F),{href:o.route("crm.tickets.show",a.id),class:"text-subtitle-1 font-weight-bold text-decoration-none text-primary"},{default:t(()=>[r(i(a.subject),1)]),_:2},1032,["href"]),s("span",de,i(a.description),1)])]),s("td",null,[a.client?(n(),J(k(F),{key:0,href:o.route("crm.clients.show",a.client.id),class:"text-body-2 text-decoration-none text-secondary"},{default:t(()=>[r(i(a.client.name),1)]),_:2},1032,["href"])):(n(),p("span",ce,"N/A"))]),s("td",null,[e(w,{color:M(a.status),size:"x-small",label:"",class:"text-uppercase font-weight-bold"},{default:t(()=>[r(i(a.status.replace("_"," ")),1)]),_:2},1032,["color"])]),s("td",null,[e(w,{color:O(a.priority),size:"x-small",variant:"outlined",class:"text-uppercase font-weight-bold"},{default:t(()=>[r(i(a.priority),1)]),_:2},1032,["color"])]),s("td",null,[e(w,{size:"x-small",variant:"tonal",class:"text-uppercase"},{default:t(()=>[r(i(a.category),1)]),_:2},1024)]),s("td",null,[s("span",me,i(new Date(a.created_at).toLocaleDateString()),1)]),s("td",pe,[e(K,null,{activator:t(({props:b})=>[e(_,X({icon:"mdi-pencil",size:"small"},{ref_for:!0},b),null,16)]),default:t(()=>[e(Q,null,{default:t(()=>[e(g,{to:o.route("crm.tickets.show",a.id)},{prepend:t(()=>[e(f,null,{default:t(()=>[...l[10]||(l[10]=[r("mdi-eye",-1)])]),_:1})]),default:t(()=>[e(x,null,{default:t(()=>[...l[11]||(l[11]=[r("View Details",-1)])]),_:1})]),_:1},8,["to"]),e(g,{to:o.route("crm.tickets.edit",a.id)},{prepend:t(()=>[e(f,null,{default:t(()=>[...l[12]||(l[12]=[r("mdi-pencil",-1)])]),_:1})]),default:t(()=>[e(x,null,{default:t(()=>[...l[13]||(l[13]=[r("Edit Ticket",-1)])]),_:1})]),_:1},8,["to"]),e(g,{onClick:b=>I(a.id)},{prepend:t(()=>[e(f,null,{default:t(()=>[...l[14]||(l[14]=[r("mdi-account-convert-outline",-1)])]),_:1})]),default:t(()=>[e(x,null,{default:t(()=>[...l[15]||(l[15]=[r("Convert to Lead",-1)])]),_:1})]),_:1},8,["onClick"]),e(g,{onClick:b=>$(a.id)},{prepend:t(()=>[e(f,null,{default:t(()=>[...l[16]||(l[16]=[r("mdi-currency-usd",-1)])]),_:1})]),default:t(()=>[e(x,null,{default:t(()=>[...l[17]||(l[17]=[r("Convert to Deal",-1)])]),_:1})]),_:1},8,["onClick"]),e(g,{onClick:b=>B(a.id)},{prepend:t(()=>[e(f,null,{default:t(()=>[...l[18]||(l[18]=[r("mdi-delete",-1)])]),_:1})]),default:t(()=>[e(x,null,{default:t(()=>[...l[19]||(l[19]=[r("Delete Ticket",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1}),e(N),s("div",fe,[e(ee,{modelValue:u.tickets.current_page,"onUpdate:modelValue":[l[3]||(l[3]=a=>u.tickets.current_page=a),l[4]||(l[4]=a=>k(y).get(o.route("crm.tickets.index"),{page:a,search:d.value,status:c.value,priority:m.value},{preserveState:!0,preserveScroll:!0}))],length:u.tickets.last_page,size:"small"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{he as default};
