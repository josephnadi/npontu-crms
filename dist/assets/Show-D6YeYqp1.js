import{o as n,N as f,b as e,v as u,U as N,a,l as g,n as o,h as s,O as x,j as y,_ as v,p as b,S as i,a6 as L,s as j,T as w,X as $,c as m,t as B,$ as T,f as r,Z as p,a8 as I,W as z,P as D,R as E,x as P,a7 as V}from"./app-CajJQkEm.js";import{_ as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CUimra8q.js";import{_ as q,A as F}from"./ActivityForm-z_B-xygN.js";import"./LoaderWrapper-CM7phn5N.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-CbPhcYUv.js";const G={class:"mb-6 d-flex align-center"},H={class:"text-h5 font-weight-bold mb-1"},M={class:"d-flex align-center gap-2"},O={class:"text-h5 font-weight-bold text-primary"},R={class:"text-body-1"},W={class:"mb-4"},X={class:"d-flex align-center"},Z={key:1,class:"text-body-1"},J={class:"d-flex align-center"},K={key:1,class:"text-body-1"},Q={class:"mb-4"},Y={class:"d-flex align-center"},_={class:"text-body-1"},de={__name:"Show",props:{deal:{type:Object,required:!0},stages:{type:Array,required:!0}},setup(t){const h=t,k=d=>{V.put(window.route("crm.deals.updateStage",h.deal.id),{deal_stage_id:d},{preserveScroll:!0})},C=d=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(d),S=d=>d?new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",A=()=>{confirm("Are you sure you want to delete this deal?")&&V.delete(window.route("crm.deals.destroy",h.deal.id))};return(d,l)=>(n(),f(w,null,[e(u(N),{title:`Deal: ${t.deal.title}`},null,8,["title"]),e(U,null,{default:a(()=>[e(g,{justify:"center"},{default:a(()=>[e(o,{cols:"12",md:"8"},{default:a(()=>[s("div",G,[e(u(x),{href:d.route("crm.deals.index"),class:"mr-4"},{default:a(()=>[e(y,{icon:"",variant:"text"},{default:a(()=>[e(v,{name:"custom-chevron-left",style:{width:"20px",height:"20px"}})]),_:1})]),_:1},8,["href"]),l[0]||(l[0]=s("h2",{class:"text-h4 font-weight-bold"},"Deal Details",-1))]),e(b,{class:"pa-6 mb-6"},{default:a(()=>[e(g,null,{default:a(()=>[e(o,{cols:"12",class:"d-flex justify-space-between align-start"},{default:a(()=>[s("div",null,[s("h3",H,i(t.deal.title),1),s("div",M,[e(L,null,{activator:a(({props:c})=>[e(p,I(c,{color:t.deal.stage?.color||"primary",variant:"tonal",size:"small",class:"cursor-pointer"}),{default:a(()=>[r(i(t.deal.stage?.name)+" ("+i(t.deal.probability)+"%) ",1),e(z,{end:"",size:"x-small"},{default:a(()=>[...l[1]||(l[1]=[r("mdi-chevron-down",-1)])]),_:1})]),_:1},16,["color"])]),default:a(()=>[e(j,{density:"compact"},{default:a(()=>[(n(!0),f(w,null,$(t.stages,c=>(n(),m(B,{key:c.id,value:c.id,onClick:ee=>k(c.id),active:c.id===t.deal.deal_stage_id},{default:a(()=>[e(T,null,{default:a(()=>[r(i(c.name),1)]),_:2},1024)]),_:2},1032,["value","onClick","active"]))),128))]),_:1})]),_:1})])]),s("div",O,i(C(t.deal.value)),1)]),_:1}),t.deal.description?(n(),m(o,{key:0,cols:"12"},{default:a(()=>[l[2]||(l[2]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Description",-1)),s("p",R,i(t.deal.description),1)]),_:1})):D("",!0),t.deal.status==="lost"&&t.deal.lost_reason?(n(),m(o,{key:1,cols:"12"},{default:a(()=>[e(E,{type:"error",variant:"tonal",title:"Deal Lost",text:t.deal.lost_reason,class:"mt-2"},null,8,["text"])]),_:1})):D("",!0),e(o,{cols:"12"},{default:a(()=>[e(P,{class:"my-4"})]),_:1}),e(o,{cols:"12",md:"6"},{default:a(()=>[s("div",W,[l[3]||(l[3]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Contact Person",-1)),s("div",X,[e(v,{name:"custom-user-fill",class:"mr-2",style:{width:"18px",height:"18px"}}),t.deal.contact?(n(),m(u(x),{key:0,href:d.route("crm.contacts.show",t.deal.contact.id),class:"text-primary text-decoration-none font-weight-medium"},{default:a(()=>[r(i(t.deal.contact.first_name)+" "+i(t.deal.contact.last_name),1)]),_:1},8,["href"])):(n(),f("span",Z,i(t.deal.contact_name||"Not assigned"),1))])]),s("div",null,[l[4]||(l[4]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Client/Company",-1)),s("div",J,[e(v,{name:"custom-building",class:"mr-2",style:{width:"18px",height:"18px"}}),t.deal.client?(n(),m(u(x),{key:0,href:d.route("crm.clients.show",t.deal.client.id),class:"text-primary text-decoration-none font-weight-medium"},{default:a(()=>[r(i(t.deal.client.name),1)]),_:1},8,["href"])):(n(),f("span",K,i(t.deal.client_name||"Not assigned"),1))])])]),_:1}),e(o,{cols:"12",md:"6"},{default:a(()=>[s("div",Q,[l[5]||(l[5]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Expected Close Date",-1)),s("div",Y,[e(v,{name:"custom-calendar",class:"mr-2",style:{width:"18px",height:"18px"}}),s("span",_,i(S(t.deal.expected_close_date)),1)])]),s("div",null,[l[6]||(l[6]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Status",-1)),e(p,{color:t.deal.status==="open"?"info":t.deal.status==="won"?"success":"error",variant:"flat",size:"small",class:"text-uppercase"},{default:a(()=>[r(i(t.deal.status||"open"),1)]),_:1},8,["color"])])]),_:1}),e(o,{cols:"12",class:"mt-6 d-flex justify-end"},{default:a(()=>[e(y,{color:"error",variant:"text",class:"mr-auto",onClick:A},{default:a(()=>[...l[7]||(l[7]=[r("Delete Deal",-1)])]),_:1}),e(u(x),{href:d.route("crm.deals.edit",t.deal.id),class:"text-decoration-none mr-2"},{default:a(()=>[e(y,{variant:"outlined",color:"secondary"},{default:a(()=>[...l[8]||(l[8]=[r("Edit Deal",-1)])]),_:1})]),_:1},8,["href"]),e(y,{color:"primary",href:d.route("crm.deals.pipeline")},{default:a(()=>[...l[9]||(l[9]=[r("Update Stage",-1)])]),_:1},8,["href"])]),_:1})]),_:1})]),_:1}),e(b,{class:"pa-6"},{default:a(()=>[l[10]||(l[10]=s("div",{class:"d-flex justify-space-between align-center mb-4"},[s("h3",{class:"text-h5 font-weight-bold"},"Log Activity")],-1)),e(q,{"activityable-type":"App\\Models\\Deal","activityable-id":t.deal.id},null,8,["activityable-id"])]),_:1})]),_:1}),e(o,{cols:"12",md:"4"},{default:a(()=>[l[11]||(l[11]=s("div",{class:"mb-6"},[s("h3",{class:"text-h5 font-weight-bold"},"Activity Timeline")],-1)),e(F,{activities:t.deal.activities||[]},null,8,["activities"])]),_:1})]),_:1})]),_:1})],64))}};export{de as default};
