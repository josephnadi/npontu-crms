import{r as y,D as U,a8 as v,o as d,M as u,b as e,u as p,T as E,a as t,k as N,m as b,h as o,N as k,i,f as s,n as A,p as S,g as I,v as D,a4 as O,S as L,W as M,R as f,O as z,Y as R,a6 as g,a7 as x,U as C,a9 as W,aa as Y,c as q,ab as G,ac as H,ad as J}from"./app-CqcLQhWc.js";import{_ as K}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{l as Q}from"./lodash-CdjocJhF.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const X={key:0},Z={key:0},ee={key:1},te={class:"text-right"},le={class:"d-flex justify-end gap-1"},ae={key:0},oe={class:"pa-4 d-flex justify-center"},ce={__name:"Index",props:{clients:Object,filters:Object},setup(c){const V=y(c.filters.search||""),T=y(!1),h=y(!1),w=y(!1),m=y(null);U(V,Q.debounce(n=>{v.get(route("crm.clients.index"),{search:n},{preserveState:!0,replace:!0,preserveScroll:!0,onStart:()=>T.value=!0,onFinish:()=>T.value=!1})},500));const P=n=>{confirm("Are you sure you want to delete this client?")&&v.delete(route("crm.clients.destroy",n))},$=n=>{m.value=n,h.value=!0},j=()=>{m.value&&(w.value=!0,v.post(route("crm.clients.convert",m.value.id),{},{onFinish:()=>{w.value=!1,h.value=!1,m.value=null}}))},B=n=>{confirm("Convert this client to a Partner?")&&v.post(route("crm.clients.convert-to-partner",n))},F=n=>{confirm("Create a support ticket for this client?")&&v.post(route("crm.clients.convert-to-ticket",n))};return(n,l)=>(d(),u(L,null,[e(p(E),{title:"Clients"}),e(K,null,{default:t(()=>[e(N,null,{default:t(()=>[e(b,{cols:"12",class:"d-flex justify-space-between align-center mb-4"},{default:t(()=>[l[6]||(l[6]=o("div",null,[o("h2",{class:"text-h3 font-weight-bold"},"Clients"),o("p",{class:"text-subtitle-1 text-medium-emphasis"},"Manage your customer companies and organizations")],-1)),e(p(k),{href:n.route("crm.clients.create")},{default:t(()=>[e(i,{color:"primary","prepend-icon":"mdi-plus"},{default:t(()=>[...l[5]||(l[5]=[s("Add Client",-1)])]),_:1})]),_:1},8,["href"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(A,{elevation:"0",border:""},{default:t(()=>[e(S,{class:"pa-4"},{default:t(()=>[e(N,null,{default:t(()=>[e(b,{cols:"12",md:"4"},{default:t(()=>[e(I,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=a=>V.value=a),"prepend-inner-icon":"mdi-magnify",label:"Search clients...",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D),e(O,null,{default:t(()=>[l[14]||(l[14]=o("thead",null,[o("tr",null,[o("th",{class:"text-left font-weight-bold"},"Name"),o("th",{class:"text-left font-weight-bold"},"Industry"),o("th",{class:"text-left font-weight-bold"},"Location"),o("th",{class:"text-left font-weight-bold"},"Contacts"),o("th",{class:"text-left font-weight-bold"},"Phone"),o("th",{class:"text-right font-weight-bold"},"Actions")])],-1)),o("tbody",null,[(d(!0),u(L,null,M(c.clients.data,a=>(d(),u("tr",{key:a.id},[o("td",null,[e(p(k),{href:n.route("crm.clients.show",a.id),class:"text-decoration-none font-weight-bold text-primary"},{default:t(()=>[s(f(a.name),1)]),_:2},1032,["href"])]),o("td",null,f(a.industry||"N/A"),1),o("td",null,[a.city?(d(),u("span",X,[s(f(a.city),1),a.country?(d(),u("span",Z,", "+f(a.country),1)):z("",!0)])):(d(),u("span",ee,"N/A"))]),o("td",null,[e(R,{size:"small",color:"info",variant:"flat"},{default:t(()=>[s(f(a.contacts_count)+" Contacts ",1)]),_:2},1024)]),o("td",null,f(a.phone||"N/A"),1),o("td",te,[o("div",le,[e(p(k),{href:n.route("crm.clients.show",a.id),class:"text-decoration-none"},{default:t(()=>[e(g,{text:"View Details"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"info"},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[7]||(l[7]=[s("mdi-eye",-1)])]),_:1})]),_:1},16)]),_:1})]),_:1},8,["href"]),e(p(k),{href:n.route("crm.clients.edit",a.id),class:"text-decoration-none"},{default:t(()=>[e(g,{text:"Edit"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"primary"},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[8]||(l[8]=[s("mdi-pencil",-1)])]),_:1})]),_:1},16)]),_:1})]),_:1},8,["href"]),e(g,{text:"Convert to Lead"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"warning",onClick:_=>$(a)},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[9]||(l[9]=[s("mdi-account-convert-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),e(g,{text:"Convert to Partner"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"primary",onClick:_=>B(a.id)},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[10]||(l[10]=[s("mdi-handshake-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),e(g,{text:"Convert to Ticket"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"info",onClick:_=>F(a.id)},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[11]||(l[11]=[s("mdi-ticket-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),e(g,{text:"Delete"},{activator:t(({props:r})=>[e(i,x({size:"x-small",icon:"",color:"error",onClick:_=>P(a.id)},{ref_for:!0},r),{default:t(()=>[e(C,{size:"small"},{default:t(()=>[...l[12]||(l[12]=[s("mdi-delete",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024)])])]))),128)),c.clients.data.length===0?(d(),u("tr",ae,[...l[13]||(l[13]=[o("td",{colspan:"6",class:"text-center py-8 text-medium-emphasis"},' No clients found. Click "Add Client" to get started. ',-1)])])):z("",!0)])]),_:1}),e(D),o("div",oe,[e(W,{modelValue:c.clients.current_page,"onUpdate:modelValue":[l[1]||(l[1]=a=>c.clients.current_page=a),l[2]||(l[2]=a=>p(v).get(n.route("crm.clients.index"),{page:a,search:V.value},{preserveState:!0}))],length:c.clients.last_page,size:"small"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1}),e(Y,{modelValue:h.value,"onUpdate:modelValue":l[4]||(l[4]=a=>h.value=a),"max-width":"500px"},{default:t(()=>[m.value?(d(),q(A,{key:0},{default:t(()=>[e(G,{class:"pa-4 bg-warning text-white"},{default:t(()=>[s(" Convert "+f(m.value.name)+" to Lead? ",1)]),_:1}),e(S,{class:"pa-4 pt-6"},{default:t(()=>[...l[15]||(l[15]=[s(" This will archive the client and its contacts, and create a new lead from the primary contact information. Activities and engagements will be migrated to the new lead. ",-1)])]),_:1}),e(H,{class:"pa-4"},{default:t(()=>[e(J),e(i,{variant:"text",onClick:l[3]||(l[3]=a=>h.value=!1)},{default:t(()=>[...l[16]||(l[16]=[s("Cancel",-1)])]),_:1}),e(i,{color:"warning",variant:"elevated",loading:w.value,onClick:j},{default:t(()=>[...l[17]||(l[17]=[s(" Confirm Conversion ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"])]),_:1})],64))}};export{ce as default};
