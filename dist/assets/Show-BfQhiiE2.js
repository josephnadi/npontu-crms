import{o as r,M as c,b as t,u as y,T as H,a as l,l as J,k as _,m,n as f,p as b,h as s,i as u,R as i,Y as h,f as d,v as w,af as K,ag as C,ah as Q,ai as D,am as E,c as v,q as Z,S as j,W as V,s as tt,X as P,a5 as F,w as M,a2 as I,N,U as z,O as T,bi as et,a4 as R,a8 as S,as as st,ao as lt,an as at,r as W,F as ot}from"./app-CqcLQhWc.js";import{_ as it}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{d as nt}from"./vuedraggable.umd-BMc5FPIt.js";import{_ as dt}from"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const rt={class:"d-flex align-center"},ut={class:"d-flex align-center gap-2"},ct={class:"text-h5 mb-0"},mt={class:"d-flex gap-2"},ft={class:"d-flex justify-space-between align-center mb-6"},pt={class:"text-h5 font-weight-bold text-primary"},bt={class:"text-body-1 mb-6 text-medium-emphasis"},gt={class:"mb-4"},xt={class:"text-body-1 font-weight-medium"},ht={class:"mb-4"},vt={class:"text-body-1 font-weight-medium"},yt={class:"mb-4"},wt={class:"text-body-1 font-weight-bold text-success"},jt={class:"mb-4"},kt={class:"text-body-1 font-weight-medium"},_t={key:0},Vt={class:"d-flex align-center mb-4"},zt={class:"text-caption text-medium-emphasis"},Ct={key:1,class:"text-center py-4 text-medium-emphasis"},Dt={class:"d-flex align-center mb-4"},Tt={class:"text-caption text-medium-emphasis"},St={class:"d-flex align-center gap-4"},At={class:"text-right"},Pt={key:0},It={class:"d-flex align-center mb-3"},Nt={class:"text-subtitle-1 font-weight-bold"},Bt={class:"d-flex justify-space-between align-start mb-2"},Ut={class:"text-body-2 font-weight-bold"},$t={class:"d-flex align-center justify-space-between mt-4"},Lt={class:"d-flex align-center"},Ot={class:"text-caption text-medium-emphasis"},Et={class:"text-caption"},Ft={class:"text-h5 font-weight-bold"},Mt={class:"text-caption"},Rt={class:"text-h5 font-weight-bold text-primary"},Wt={class:"mt-4 text-left"},qt={class:"d-flex justify-space-between mb-1"},Xt={class:"text-caption font-weight-bold text-success"},Yt={class:"text-h5 font-weight-bold text-warning"},Gt={class:"text-h5 font-weight-bold text-error"},Ht={class:"font-weight-bold"},Jt={class:"text-right font-weight-bold"},Kt={class:"text-right"},Qt={key:0},Zt={class:"text-caption text-medium-emphasis"},te={class:"mb-4"},ee={class:"d-flex justify-space-between align-center mb-1"},se={class:"text-subtitle-1 font-weight-bold"},le={class:"text-body-2 text-medium-emphasis"},ae={key:0,class:"text-center py-10 text-medium-emphasis"},oe={__name:"Show",props:{project:Object,invoices:Array,financials:Object},setup(o){const B=o,k=W("overview"),A=W("table"),q=[{value:"pending",title:"Pending",color:"warning"},{value:"in_progress",title:"In Progress",color:"info"},{value:"completed",title:"Completed",color:"success"}],U=ot(()=>{const n={pending:[],in_progress:[],completed:[]};return B.project.tasks.forEach(e=>{n[e.status]&&n[e.status].push(e)}),n}),X=(n,e)=>{if(n.added){const a=n.added.element;Y(a,e)}},Y=(n,e)=>{S.patch(route("crm.tasks.update",n.id),{status:e,title:n.title,priority:n.priority},{preserveScroll:!0})},$=n=>{switch(n){case"pending":return"warning";case"in_progress":return"info";case"completed":return"success";case"cancelled":return"error";default:return"grey"}},L=n=>{switch(n){case"low":return"grey";case"medium":return"info";case"high":return"warning";case"urgent":return"error";default:return"grey"}},g=n=>n?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n):"$0.00",x=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Not set",G=()=>{confirm("Are you sure you want to delete this project?")&&S.delete(route("crm.projects.destroy",B.project.id))},O=n=>{const e=n.status==="completed"?"pending":"completed";S.patch(route("crm.tasks.update",n.id),{status:e,title:n.title,priority:n.priority},{preserveScroll:!0})};return(n,e)=>(r(),c(j,null,[t(y(H),{title:o.project.name},null,8,["title"]),t(it,null,{default:l(()=>[t(J,{fluid:""},{default:l(()=>[t(_,null,{default:l(()=>[t(m,{cols:"12"},{default:l(()=>[t(f,{elevation:"0",class:"mb-6"},{default:l(()=>[t(b,{class:"d-flex align-center justify-space-between py-4"},{default:l(()=>[s("div",rt,[t(u,{icon:"mdi-arrow-left",variant:"text",class:"mr-2",onClick:e[0]||(e[0]=a=>n.$window.history.back())}),s("div",null,[s("div",ut,[s("h1",ct,i(o.project.name),1),t(h,{color:L(o.project.priority),size:"x-small",variant:"tonal",class:"text-uppercase font-weight-bold"},{default:l(()=>[d(i(o.project.priority),1)]),_:1},8,["color"])]),t(h,{color:$(o.project.status),size:"small",label:"",class:"mt-1 text-uppercase font-weight-bold"},{default:l(()=>[d(i(o.project.status.replace("_"," ")),1)]),_:1},8,["color"])])]),s("div",mt,[t(u,{color:"primary",variant:"outlined","prepend-icon":"mdi-pencil",to:n.route("crm.projects.edit",o.project.id)},{default:l(()=>[...e[6]||(e[6]=[d(" Edit ",-1)])]),_:1},8,["to"]),t(u,{color:"error",variant:"outlined","prepend-icon":"mdi-delete",onClick:G},{default:l(()=>[...e[7]||(e[7]=[d(" Delete ",-1)])]),_:1})])]),_:1}),t(w),t(K,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),color:"primary"},{default:l(()=>[t(C,{value:"overview","prepend-icon":"mdi-information-outline"},{default:l(()=>[...e[8]||(e[8]=[d("Overview",-1)])]),_:1}),t(C,{value:"tasks","prepend-icon":"mdi-checkbox-marked-circle-outline"},{default:l(()=>[d("Tasks ("+i(o.project.tasks.length)+")",1)]),_:1}),t(C,{value:"financials","prepend-icon":"mdi-cash-multiple"},{default:l(()=>[...e[9]||(e[9]=[d("Financials",-1)])]),_:1}),t(C,{value:"activities","prepend-icon":"mdi-history"},{default:l(()=>[...e[10]||(e[10]=[d("Activities",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Q,{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=a=>k.value=a)},{default:l(()=>[t(D,{value:"overview"},{default:l(()=>[t(_,null,{default:l(()=>[t(m,{cols:"12",md:"8"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"mb-6"},{default:l(()=>[t(b,{class:"pa-6"},{default:l(()=>[s("div",ft,[e[11]||(e[11]=s("h3",{class:"text-h6 font-weight-bold"},"Project Progress",-1)),s("span",pt,i(o.project.progress)+"%",1)]),t(E,{modelValue:o.project.progress,"onUpdate:modelValue":e[2]||(e[2]=a=>o.project.progress=a),color:"primary",height:"12",rounded:"",class:"mb-6"},null,8,["modelValue"]),e[16]||(e[16]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-2"},"Description",-1)),s("p",bt,i(o.project.description||"No description provided."),1),t(w,{class:"mb-6"}),t(_,null,{default:l(()=>[t(m,{cols:"12",sm:"6",md:"3"},{default:l(()=>[s("div",gt,[e[12]||(e[12]=s("span",{class:"text-caption text-medium-emphasis d-block"},"Start Date",-1)),s("span",xt,i(x(o.project.start_date)),1)])]),_:1}),t(m,{cols:"12",sm:"6",md:"3"},{default:l(()=>[s("div",ht,[e[13]||(e[13]=s("span",{class:"text-caption text-medium-emphasis d-block"},"End Date",-1)),s("span",vt,i(x(o.project.end_date)),1)])]),_:1}),t(m,{cols:"12",sm:"6",md:"3"},{default:l(()=>[s("div",yt,[e[14]||(e[14]=s("span",{class:"text-caption text-medium-emphasis d-block"},"Budget",-1)),s("span",wt,i(g(o.project.budget)),1)])]),_:1}),t(m,{cols:"12",sm:"6",md:"3"},{default:l(()=>[s("div",jt,[e[15]||(e[15]=s("span",{class:"text-caption text-medium-emphasis d-block"},"Owner",-1)),s("span",kt,i(o.project.owner.name),1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(f,{border:"",elevation:"0",class:"mb-6"},{default:l(()=>[t(b,{class:"pa-4 d-flex justify-space-between align-center"},{default:l(()=>[e[18]||(e[18]=s("h3",{class:"text-h6 font-weight-bold"},"Recent Tasks",-1)),t(u,{variant:"text",color:"primary",onClick:e[3]||(e[3]=a=>k.value="tasks")},{default:l(()=>[...e[17]||(e[17]=[d("View All",-1)])]),_:1})]),_:1}),t(w),o.project.tasks.length>0?(r(),v(Z,{key:0},{default:l(()=>[(r(!0),c(j,null,V(o.project.tasks.slice(0,5),a=>(r(),v(tt,{key:a.id,title:a.title},{prepend:l(()=>[t(F,{"model-value":a.status==="completed",onClick:M(p=>O(a),["stop"]),color:"success"},null,8,["model-value","onClick"])]),subtitle:l(()=>[s("span",{class:P({"text-error":a.due_date&&new Date(a.due_date)<new Date&&a.status!=="completed"})}," Due: "+i(x(a.due_date)),3)]),append:l(()=>[t(h,{size:"x-small",color:a.priority==="high"?"error":"grey"},{default:l(()=>[d(i(a.priority),1)]),_:2},1032,["color"])]),_:2},1032,["title"]))),128))]),_:1})):(r(),v(b,{key:1,class:"text-center py-6 text-medium-emphasis"},{default:l(()=>[...e[19]||(e[19]=[d(" No tasks assigned to this project. ",-1)])]),_:1}))]),_:1})]),_:1}),t(m,{cols:"12",md:"4"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"mb-6"},{default:l(()=>[t(b,{class:"pa-6"},{default:l(()=>[e[23]||(e[23]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-4"},"Client Information",-1)),o.project.client?(r(),c("div",_t,[s("div",Vt,[t(I,{color:"primary",size:"48",class:"mr-4 text-white"},{default:l(()=>[d(i(o.project.client.name.charAt(0)),1)]),_:1}),s("div",null,[t(y(N),{href:n.route("crm.clients.show",o.project.client.id),class:"text-subtitle-1 font-weight-bold text-decoration-none text-primary d-block"},{default:l(()=>[d(i(o.project.client.name),1)]),_:1},8,["href"]),s("span",zt,i(o.project.client.email),1)])]),t(u,{block:"",variant:"outlined",size:"small",to:n.route("crm.clients.show",o.project.client.id)},{default:l(()=>[...e[20]||(e[20]=[d(" View Client Profile ",-1)])]),_:1},8,["to"])])):(r(),c("div",Ct,[t(z,{size:"48",class:"mb-2"},{default:l(()=>[...e[21]||(e[21]=[d("mdi-account-off-outline",-1)])]),_:1}),e[22]||(e[22]=s("p",null,"No client assigned",-1))]))]),_:1})]),_:1}),o.project.deal?(r(),v(f,{key:0,border:"",elevation:"0",class:"mb-6"},{default:l(()=>[t(b,{class:"pa-6"},{default:l(()=>[e[25]||(e[25]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-4"},"Source Deal",-1)),s("div",Dt,[t(I,{color:"success",size:"48",variant:"tonal",class:"mr-4"},{default:l(()=>[t(z,null,{default:l(()=>[...e[24]||(e[24]=[d("mdi-handshake-outline",-1)])]),_:1})]),_:1}),s("div",null,[t(y(N),{href:n.route("crm.deals.show",o.project.deal.id),class:"text-subtitle-1 font-weight-bold text-decoration-none text-primary d-block"},{default:l(()=>[d(i(o.project.deal.title),1)]),_:1},8,["href"]),s("span",Tt,"Value: "+i(g(o.project.deal.value)),1)])])]),_:1})]),_:1})):T("",!0)]),_:1})]),_:1})]),_:1}),t(D,{value:"tasks"},{default:l(()=>[t(f,{border:"",elevation:"0"},{default:l(()=>[t(b,{class:"pa-4 d-flex justify-space-between align-center"},{default:l(()=>[s("div",St,[e[26]||(e[26]=s("h3",{class:"text-h6 font-weight-bold mb-0"},"Project Tasks",-1)),t(et,{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=a=>A.value=a),mandatory:"",density:"compact",color:"primary",variant:"outlined"},{default:l(()=>[t(u,{value:"table",icon:"mdi-table-large",size:"small"}),t(u,{value:"board",icon:"mdi-view-column",size:"small"})]),_:1},8,["modelValue"])]),t(u,{color:"primary","prepend-icon":"mdi-plus",size:"small",to:n.route("crm.tasks.create",{project_id:o.project.id})},{default:l(()=>[...e[27]||(e[27]=[d(" Add Task ",-1)])]),_:1},8,["to"])]),_:1}),t(w),A.value==="table"?(r(),v(R,{key:0},{default:l(()=>[e[29]||(e[29]=s("thead",null,[s("tr",null,[s("th",{style:{width:"50px"}}),s("th",null,"Task"),s("th",null,"Priority"),s("th",null,"Due Date"),s("th",null,"Assigned To"),s("th",{class:"text-right"},"Actions")])],-1)),s("tbody",null,[(r(!0),c(j,null,V(o.project.tasks,a=>(r(),c("tr",{key:a.id},[s("td",null,[t(F,{"model-value":a.status==="completed",onClick:M(p=>O(a),["stop"]),color:"success"},null,8,["model-value","onClick"])]),s("td",null,[s("div",{class:P({"text-decoration-line-through text-medium-emphasis":a.status==="completed"})},[t(y(N),{href:n.route("crm.tasks.show",a.id),class:"text-decoration-none text-high-emphasis"},{default:l(()=>[d(i(a.title),1)]),_:2},1032,["href"])],2)]),s("td",null,[t(h,{size:"x-small",color:a.priority==="high"?"error":"grey"},{default:l(()=>[d(i(a.priority),1)]),_:2},1032,["color"])]),s("td",null,[s("span",{class:P({"text-error":a.due_date&&new Date(a.due_date)<new Date&&a.status!=="completed"})},i(x(a.due_date)),3)]),s("td",null,i(a.assigned_to_name||"Unassigned"),1),s("td",At,[t(u,{icon:"mdi-pencil",variant:"text",size:"x-small",to:n.route("crm.tasks.edit",a.id)},null,8,["to"]),t(u,{icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:p=>y(S).delete(n.route("crm.tasks.destroy",a.id))},null,8,["onClick"])])]))),128)),o.project.tasks.length===0?(r(),c("tr",Pt,[...e[28]||(e[28]=[s("td",{colspan:"6",class:"text-center py-10 text-medium-emphasis"}," No tasks found for this project. ",-1)])])):T("",!0)])]),_:1})):(r(),v(b,{key:1,class:"pa-4 bg-grey-lighten-4"},{default:l(()=>[t(_,null,{default:l(()=>[(r(),c(j,null,V(q,a=>t(m,{key:a.value,cols:"12",md:"4"},{default:l(()=>[s("div",It,[t(h,{color:a.color,size:"small",class:"mr-2",label:""},{default:l(()=>[d(i(U.value[a.value].length),1)]),_:2},1032,["color"]),s("span",Nt,i(a.title),1)]),t(y(nt),{list:U.value[a.value],group:"tasks","item-key":"id",class:"kanban-column",onChange:p=>X(p,a.value)},{item:l(({element:p})=>[t(f,{border:"",elevation:"0",class:"mb-3 task-card",to:n.route("crm.tasks.show",p.id)},{default:l(()=>[t(b,{class:"pa-3"},{default:l(()=>[s("div",Bt,[s("span",Ut,i(p.title),1),t(h,{size:"x-small",color:L(p.priority),variant:"tonal"},{default:l(()=>[d(i(p.priority),1)]),_:2},1032,["color"])]),s("div",$t,[s("div",Lt,[t(z,{size:"small",color:"medium-emphasis",class:"mr-1"},{default:l(()=>[...e[30]||(e[30]=[d("mdi-calendar-clock",-1)])]),_:1}),s("span",Ot,i(x(p.due_date)),1)]),t(I,{size:"24",color:"grey-lighten-2"},{default:l(()=>[s("span",Et,i(p.assigned_to_name?p.assigned_to_name.charAt(0):"?"),1)]),_:2},1024)])]),_:2},1024)]),_:2},1032,["to"])]),_:1},8,["list","onChange"])]),_:2},1024)),64))]),_:1})]),_:1}))]),_:1})]),_:1}),t(D,{value:"financials"},{default:l(()=>[t(_,null,{default:l(()=>[t(m,{cols:"12",md:"3"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"text-center pa-4 h-100"},{default:l(()=>[e[31]||(e[31]=s("span",{class:"text-caption text-medium-emphasis d-block mb-1"},"Total Budget",-1)),s("span",Ft,i(g(o.project.budget)),1),t(st,{"model-value":o.financials.budget_usage_percent,color:o.financials.budget_usage_percent>100?"error":"primary",size:"64",width:"6",class:"mt-4"},{default:l(()=>[s("span",Mt,i(o.financials.budget_usage_percent)+"%",1)]),_:1},8,["model-value","color"]),e[32]||(e[32]=s("span",{class:"text-caption d-block mt-2"},"Budget Usage",-1))]),_:1})]),_:1}),t(m,{cols:"12",md:"3"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"text-center pa-4 h-100"},{default:l(()=>[e[34]||(e[34]=s("span",{class:"text-caption text-medium-emphasis d-block mb-1"},"Total Invoiced",-1)),s("span",Rt,i(g(o.financials.total_invoiced)),1),s("div",Wt,[s("div",qt,[e[33]||(e[33]=s("span",{class:"text-caption"},"Paid",-1)),s("span",Xt,i(g(o.financials.paid_amount)),1)]),t(E,{"model-value":o.financials.paid_amount/o.financials.total_invoiced*100,color:"success",height:"4",rounded:""},null,8,["model-value"])])]),_:1})]),_:1}),t(m,{cols:"12",md:"3"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"text-center pa-4 h-100"},{default:l(()=>[e[36]||(e[36]=s("span",{class:"text-caption text-medium-emphasis d-block mb-1"},"Pending Invoices",-1)),s("span",Yt,i(g(o.financials.pending_amount)),1),t(z,{color:"warning",size:"48",class:"mt-4"},{default:l(()=>[...e[35]||(e[35]=[d("mdi-clock-outline",-1)])]),_:1})]),_:1})]),_:1}),t(m,{cols:"12",md:"3"},{default:l(()=>[t(f,{border:"",elevation:"0",class:"text-center pa-4 h-100"},{default:l(()=>[e[38]||(e[38]=s("span",{class:"text-caption text-medium-emphasis d-block mb-1"},"Overdue Amount",-1)),s("span",Gt,i(g(o.financials.overdue_amount)),1),t(z,{color:"error",size:"48",class:"mt-4"},{default:l(()=>[...e[37]||(e[37]=[d("mdi-alert-circle-outline",-1)])]),_:1})]),_:1})]),_:1}),t(m,{cols:"12"},{default:l(()=>[t(f,{border:"",elevation:"0"},{default:l(()=>[t(b,{class:"pa-4 d-flex justify-space-between align-center"},{default:l(()=>[e[40]||(e[40]=s("h3",{class:"text-h6 font-weight-bold"},"Project Invoices",-1)),t(u,{color:"primary","prepend-icon":"mdi-plus",size:"small",to:n.route("crm.invoices.create",{project_id:o.project.id})},{default:l(()=>[...e[39]||(e[39]=[d(" Create Invoice ",-1)])]),_:1},8,["to"])]),_:1}),t(w),t(R,null,{default:l(()=>[e[42]||(e[42]=s("thead",null,[s("tr",null,[s("th",null,"Invoice #"),s("th",null,"Status"),s("th",null,"Issue Date"),s("th",null,"Due Date"),s("th",{class:"text-right"},"Amount"),s("th",{class:"text-right"},"Actions")])],-1)),s("tbody",null,[(r(!0),c(j,null,V(o.invoices,a=>(r(),c("tr",{key:a.id},[s("td",Ht,i(a.invoice_number),1),s("td",null,[t(h,{size:"x-small",color:a.status==="paid"?"success":a.status==="overdue"?"error":"warning",label:"",class:"text-uppercase"},{default:l(()=>[d(i(a.status),1)]),_:2},1032,["color"])]),s("td",null,i(x(a.issue_date)),1),s("td",null,i(x(a.due_date)),1),s("td",Jt,i(g(a.total_amount)),1),s("td",Kt,[t(u,{icon:"mdi-eye-outline",variant:"text",size:"x-small",to:n.route("crm.invoices.show",a.id)},null,8,["to"]),t(u,{icon:"mdi-pencil",variant:"text",size:"x-small",to:n.route("crm.invoices.edit",a.id)},null,8,["to"])])]))),128)),o.invoices.length===0?(r(),c("tr",Qt,[...e[41]||(e[41]=[s("td",{colspan:"6",class:"text-center py-10 text-medium-emphasis"}," No invoices found for this project. ",-1)])])):T("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(D,{value:"activities"},{default:l(()=>[t(f,{border:"",elevation:"0"},{default:l(()=>[t(b,{class:"pa-4 d-flex justify-space-between align-center"},{default:l(()=>[e[44]||(e[44]=s("h3",{class:"text-h6 font-weight-bold"},"Activity Log",-1)),t(u,{color:"primary",variant:"outlined","prepend-icon":"mdi-plus",size:"small",to:n.route("crm.activities.create",{activityable_type:"Project",activityable_id:o.project.id})},{default:l(()=>[...e[43]||(e[43]=[d(" Log Activity ",-1)])]),_:1},8,["to"])]),_:1}),t(w),t(b,{class:"pa-6"},{default:l(()=>[t(lt,{side:"end",align:"start"},{default:l(()=>[(r(!0),c(j,null,V(o.project.activities,a=>(r(),v(at,{key:a.id,"dot-color":$(a.status),size:"small"},{opposite:l(()=>[s("span",Zt,i(x(a.activity_date)),1)]),default:l(()=>[s("div",te,[s("div",ee,[s("h4",se,i(a.subject),1),t(h,{size:"x-small",label:"",class:"text-uppercase"},{default:l(()=>[d(i(a.type),1)]),_:2},1024)]),s("p",le,i(a.description),1)])]),_:2},1032,["dot-color"]))),128))]),_:1}),o.project.activities.length===0?(r(),c("div",ae," No activities logged for this project. ")):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64))}},me=dt(oe,[["__scopeId","data-v-7fbb0ad7"]]);export{me as default};
