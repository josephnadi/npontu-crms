import{r as w,D as X,o as m,M as p,b as t,u as g,T as Y,a as l,k as N,m as r,h as s,N as S,i as f,f as c,n as h,p as V,a2 as k,U as z,R as d,g as H,$ as B,c as F,a3 as J,O as A,a4 as K,a5 as O,S as L,W as Q,X as R,_ as Z,Y as ee,a6 as D,a7 as T,a8 as v,a9 as te}from"./app-CqcLQhWc.js";import{_ as le}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{d as ae}from"./debounce-CSqvcByx.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const se={class:"d-flex gap-2"},ie={class:"text-h4 font-weight-bold"},ne={class:"text-h4 font-weight-bold"},oe={class:"text-h4 font-weight-bold"},re={style:{width:"40px"}},de={class:"d-flex align-center"},ue={class:"text-capitalize"},ce={class:"font-weight-medium"},me={class:"text-caption text-grey text-truncate",style:{"max-width":"300px"}},fe={key:0},ve={class:"text-caption text-grey mb-1"},pe={key:1,class:"text-caption text-grey"},ge={class:"text-right"},xe={class:"d-flex justify-end"},ye={key:0},be={class:"pa-4 d-flex justify-center"},Se={__name:"Index",props:{activities:{type:Object,required:!0},filters:Object,stats:Object},setup(n){const _=n,x=w(_.filters?.search||""),y=w(_.filters?.type||"all"),b=w(_.filters?.status||"all"),o=w([]),C=w(!1),E=()=>{C.value=!0,v.get(route("crm.activities.index"),{search:x.value,type:y.value,status:b.value},{preserveState:!0,replace:!0,preserveScroll:!0,onStart:()=>C.value=!0,onFinish:()=>C.value=!1})};X([x,y,b],ae(()=>{E()},500));const I=i=>{v.put(route("crm.activities.complete",i.id),{},{preserveScroll:!0,onSuccess:()=>{}})},j=i=>{o.value.length!==0&&(i==="delete"?confirm(`Are you sure you want to delete ${o.value.length} activities?`)&&v.post(route("crm.activities.bulkDestroy"),{ids:o.value},{onSuccess:()=>o.value=[]}):v.post(route("crm.activities.bulkUpdate"),{ids:o.value,status:i},{onSuccess:()=>o.value=[]}))},P=i=>{confirm("Are you sure you want to delete this activity?")&&v.delete(window.route("crm.activities.destroy",i))},M=i=>{switch(i){case"call":return"custom-phone";case"meeting":return"custom-users";case"email":return"custom-mail";case"task":return"custom-check";case"note":return"custom-file-text";default:return"custom-calendar"}},q=i=>{switch(i){case"call":return"info";case"meeting":return"primary";case"email":return"warning";case"task":return"success";case"note":return"secondary";default:return"grey"}},G=i=>i?new Date(i).toLocaleString():"N/A",U=i=>{if(!i.activityable)return"#";switch(i.activityable_type.split("\\").pop().toLowerCase()){case"deal":return window.route("crm.deals.show",i.activityable_id);case"lead":return window.route("crm.leads.show",i.activityable_id);case"contact":return window.route("crm.contacts.show",i.activityable_id);case"client":return window.route("crm.clients.show",i.activityable_id);default:return"#"}},W=i=>i.activityable?i.activityable.title||i.activityable.name||"View":"Unknown";return(i,e)=>(m(),p(L,null,[t(g(Y),{title:"Activities"}),t(le,null,{default:l(()=>[t(N,null,{default:l(()=>[t(r,{cols:"12",class:"d-flex justify-space-between align-center"},{default:l(()=>[e[11]||(e[11]=s("h2",{class:"text-h4 font-weight-bold"},"Activities",-1)),s("div",se,[t(g(S),{href:i.route("crm.activities.calendar"),class:"text-decoration-none mr-2"},{default:l(()=>[t(f,{variant:"outlined","prepend-icon":"mdi-calendar"},{default:l(()=>[...e[9]||(e[9]=[c("Calendar View",-1)])]),_:1})]),_:1},8,["href"]),t(g(S),{href:i.route("crm.activities.create"),class:"text-decoration-none"},{default:l(()=>[t(f,{color:"primary","prepend-icon":"mdi-plus"},{default:l(()=>[...e[10]||(e[10]=[c("Add Activity",-1)])]),_:1})]),_:1},8,["href"])])]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(h,{border:"",elevation:"0",class:"bg-light-primary"},{default:l(()=>[t(V,{class:"d-flex align-center"},{default:l(()=>[t(k,{color:"primary",variant:"tonal",class:"mr-4"},{default:l(()=>[t(z,null,{default:l(()=>[...e[12]||(e[12]=[c("mdi-clock-outline",-1)])]),_:1})]),_:1}),s("div",null,[e[13]||(e[13]=s("div",{class:"text-subtitle-2 text-grey"},"Pending Activities",-1)),s("div",ie,d(n.stats.pending),1)])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(h,{border:"",elevation:"0",class:"bg-light-error"},{default:l(()=>[t(V,{class:"d-flex align-center"},{default:l(()=>[t(k,{color:"error",variant:"tonal",class:"mr-4"},{default:l(()=>[t(z,null,{default:l(()=>[...e[14]||(e[14]=[c("mdi-alert-circle-outline",-1)])]),_:1})]),_:1}),s("div",null,[e[15]||(e[15]=s("div",{class:"text-subtitle-2 text-grey"},"Overdue",-1)),s("div",ne,d(n.stats.overdue),1)])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(h,{border:"",elevation:"0",class:"bg-light-success"},{default:l(()=>[t(V,{class:"d-flex align-center"},{default:l(()=>[t(k,{color:"success",variant:"tonal",class:"mr-4"},{default:l(()=>[t(z,null,{default:l(()=>[...e[16]||(e[16]=[c("mdi-check-circle-outline",-1)])]),_:1})]),_:1}),s("div",null,[e[17]||(e[17]=s("div",{class:"text-subtitle-2 text-grey"},"Completed Today",-1)),s("div",oe,d(n.stats.completed_today),1)])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12"},{default:l(()=>[t(h,{class:"mb-4"},{default:l(()=>[t(V,null,{default:l(()=>[t(N,{align:"center"},{default:l(()=>[t(r,{cols:"12",md:"4"},{default:l(()=>[t(H,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),label:"Search activities...","prepend-inner-icon":"mdi-magnify","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"2"},{default:l(()=>[t(B,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),items:["all","call","meeting","email","task","note"],label:"Type","hide-details":"",variant:"outlined",density:"comfortable",class:"text-capitalize"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"2"},{default:l(()=>[t(B,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=a=>b.value=a),items:["all","pending","completed","cancelled","overdue"],label:"Status","hide-details":"",variant:"outlined",density:"comfortable",class:"text-capitalize"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4",class:"d-flex justify-end gap-2"},{default:l(()=>[o.value.length>0?(m(),F(J,{key:0},{default:l(()=>[t(f,{color:"success",variant:"outlined",size:"small",onClick:e[3]||(e[3]=a=>j("completed"))},{default:l(()=>[...e[18]||(e[18]=[c("Complete",-1)])]),_:1}),t(f,{color:"error",variant:"outlined",size:"small",onClick:e[4]||(e[4]=a=>j("delete"))},{default:l(()=>[...e[19]||(e[19]=[c("Delete",-1)])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(K,null,{default:l(()=>[s("thead",null,[s("tr",null,[s("th",re,[t(O,{"model-value":o.value.length===n.activities.data.length&&n.activities.data.length>0,onChange:e[5]||(e[5]=a=>o.value=a?n.activities.data.map(u=>u.id):[])},null,8,["model-value"])]),e[20]||(e[20]=s("th",{class:"text-left"},"Type",-1)),e[21]||(e[21]=s("th",{class:"text-left"},"Subject",-1)),e[22]||(e[22]=s("th",{class:"text-left"},"Related To",-1)),e[23]||(e[23]=s("th",{class:"text-left"},"Date",-1)),e[24]||(e[24]=s("th",{class:"text-left"},"Status",-1)),e[25]||(e[25]=s("th",{class:"text-right"},"Actions",-1))])]),s("tbody",null,[(m(!0),p(L,null,Q(n.activities.data,a=>(m(),p("tr",{key:a.id,class:R({"bg-grey-lighten-4":o.value.includes(a.id)})},[s("td",null,[t(O,{modelValue:o.value,"onUpdate:modelValue":e[6]||(e[6]=u=>o.value=u),value:a.id},null,8,["modelValue","value"])]),s("td",null,[s("div",de,[t(k,{color:q(a.type),size:"32",class:"mr-3"},{default:l(()=>[t(Z,{name:M(a.type),style:{width:"16px",height:"16px",color:"white"}},null,8,["name"])]),_:2},1032,["color"]),s("span",ue,d(a.type),1)])]),s("td",null,[s("div",ce,d(a.subject),1),s("div",me,d(a.description),1)]),s("td",null,[a.activityable?(m(),p("div",fe,[s("div",ve,d(a.activityable_type.split("\\").pop()),1),t(g(S),{href:U(a),class:"text-primary text-decoration-none font-weight-medium"},{default:l(()=>[c(d(W(a)),1)]),_:2},1032,["href"])])):(m(),p("span",pe,"Unlinked"))]),s("td",null,[s("div",{class:R({"text-error font-weight-bold":a.status==="pending"&&new Date(a.due_date||a.activity_date)<new Date})},d(G(a.activity_date)),3)]),s("td",null,[t(ee,{color:a.status==="completed"?"success":a.status==="pending"?"warning":"error",size:"x-small",variant:"tonal",class:"text-capitalize"},{default:l(()=>[c(d(a.status),1)]),_:2},1032,["color"])]),s("td",ge,[s("div",xe,[t(D,{text:"View Related"},{activator:l(({props:u})=>[t(f,T({icon:"mdi-eye",size:"small"},{ref_for:!0},u,{onClick:$=>g(v).get(U(a))}),null,16,["onClick"])]),_:2},1024),a.status==="pending"?(m(),F(D,{key:0,text:"Mark Completed"},{activator:l(({props:u})=>[t(f,T({icon:"mdi-check",size:"small",color:"success"},{ref_for:!0},u,{onClick:$=>I(a)}),null,16,["onClick"])]),_:2},1024)):A("",!0),t(D,{text:"Delete Activity"},{activator:l(({props:u})=>[t(f,T({icon:"mdi-delete",size:"small",color:"error"},{ref_for:!0},u,{onClick:$=>P(a.id)}),null,16,["onClick"])]),_:2},1024)])])],2))),128)),n.activities.data.length===0?(m(),p("tr",ye,[...e[26]||(e[26]=[s("td",{colspan:"7",class:"text-center py-8 text-grey"}," No activities found matching your criteria. ",-1)])])):A("",!0)])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12"},{default:l(()=>[s("div",be,[t(te,{modelValue:n.activities.current_page,"onUpdate:modelValue":[e[7]||(e[7]=a=>n.activities.current_page=a),e[8]||(e[8]=a=>g(v).get(i.route("crm.activities.index"),{page:a,search:x.value,type:y.value,status:b.value},{preserveState:!0}))],length:n.activities.last_page,size:"small","active-color":"primary"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1})],64))}};export{Se as default};
