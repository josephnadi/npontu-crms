import{r as p,M as Y,o as m,N as g,b as t,v as o,U as ee,a as l,l as z,n as V,h as s,W as A,f as r,p as j,ag as E,O as I,j as c,q as B,g as N,a3 as te,a0 as U,c as T,ah as le,P as h,a4 as ae,T as $,X as R,S as u,Z as se,a5 as oe,a6 as O,s as P,t as b,a7 as x,$ as y,x as L,aQ as re,a8 as q,a9 as ne,Q as K,aR as ie,aK as de,aL as ue,af as me}from"./app-CajJQkEm.js";import{_ as fe}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CUimra8q.js";import"./lodash-Dt38h8Cc.js";import{_ as ce}from"./LoaderWrapper-CM7phn5N.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-CbPhcYUv.js";const ve={class:"d-flex align-center text-caption text-medium-emphasis mb-2"},pe={class:"py-4"},ge={class:"text-right"},Ve={key:0},be={class:"pa-4 d-flex justify-center"},xe={class:"mb-4 text-body-2 text-medium-emphasis"},ye={key:0},Ce={__name:"Index",props:{leads:Object,filters:Object,dealStages:Array},setup(f){const S=f,C=p(S.filters.search||""),w=p(S.filters.status||""),k=p(S.filters.source||""),D=p(!1),v=p(!1),_=p(null),n=Y({create_client:!0,create_deal:!0,deal_title:"",deal_value:0,deal_stage_id:S.dealStages?.[0]?.id||null}),Q=i=>{_.value=i,n.deal_title=`${i.company_name||i.first_name} Deal`,v.value=!0},W=()=>{n.post(route("crm.leads.convert",_.value.id),{onSuccess:()=>{v.value=!1}})},H=(i,e)=>{x.patch(route("crm.leads.update",i.id),{...i,status:e,owner_id:i.owner_id},{preserveScroll:!0})},M=[{title:"All Statuses",value:""},{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],G=[{title:"All Sources",value:""},{title:"Website Form",value:"Website Form"},{title:"Social Media",value:"Social Media"},{title:"Referral",value:"Referral"},{title:"Direct",value:"Direct"},{title:"Email",value:"Email"}],F=()=>{D.value=!0,x.get(route("crm.leads.index"),{search:C.value,status:w.value,source:k.value},{preserveState:!0,replace:!0,onFinish:()=>D.value=!1})},X=()=>{C.value="",w.value="",k.value="",F()},Z=i=>{switch(i){case"new":return"info";case"contacted":return"warning";case"qualified":return"success";case"converted":return"primary";case"lost":return"error";default:return"grey"}},J=i=>{confirm("Are you sure you want to delete this lead?")&&x.delete(route("crm.leads.destroy",i))};return(i,e)=>(m(),g($,null,[t(o(ee),{title:"Leads"}),t(fe,null,{default:l(()=>[t(z,null,{default:l(()=>[t(V,{cols:"12",class:"mb-0"},{default:l(()=>[s("div",ve,[e[15]||(e[15]=s("span",null,"Home",-1)),t(A,{size:"14",class:"mx-1"},{default:l(()=>[...e[13]||(e[13]=[r("mdi-chevron-right",-1)])]),_:1}),e[16]||(e[16]=s("span",null,"CRM",-1)),t(A,{size:"14",class:"mx-1"},{default:l(()=>[...e[14]||(e[14]=[r("mdi-chevron-right",-1)])]),_:1}),e[17]||(e[17]=s("span",{class:"text-high-emphasis"},"Leads",-1))]),e[18]||(e[18]=s("h2",{class:"text-h3 font-weight-bold mb-6"},"Leads",-1))]),_:1}),t(V,{cols:"12"},{default:l(()=>[t(j,{elevation:"0",border:""},{default:l(()=>[t(E,{class:"pa-4 d-flex justify-space-between align-center border-bottom"},{default:l(()=>[e[20]||(e[20]=s("span",{class:"text-h6 font-weight-bold"},"Leads Management",-1)),t(o(I),{href:i.route("crm.leads.create")},{default:l(()=>[t(c,{color:"primary",flat:""},{default:l(()=>[...e[19]||(e[19]=[r("New Lead",-1)])]),_:1})]),_:1},8,["href"])]),_:1}),t(B,{class:"pa-4"},{default:l(()=>[t(z,{align:"center"},{default:l(()=>[t(V,{cols:"12",md:"4"},{default:l(()=>[t(N,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=a=>C.value=a),label:"Search",variant:"outlined",density:"comfortable","hide-details":"",onKeyup:te(F,["enter"])},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"2"},{default:l(()=>[t(U,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),items:M,label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"2"},{default:l(()=>[t(U,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),items:G,label:"Source",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:l(()=>[t(c,{color:"primary",block:"",onClick:F,flat:""},{default:l(()=>[...e[21]||(e[21]=[r("Filter",-1)])]),_:1}),t(c,{variant:"outlined",block:"",onClick:X},{default:l(()=>[...e[22]||(e[22]=[r("Clear",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),D.value?(m(),T(le,{key:0,indeterminate:"",color:"primary",height:"2"})):h("",!0),t(ae,{class:"leads-table"},{default:l(()=>[e[30]||(e[30]=s("thead",null,[s("tr",null,[s("th",{class:"text-left font-weight-bold"},"Name"),s("th",{class:"text-left font-weight-bold"},"Email"),s("th",{class:"text-left font-weight-bold"},"Company"),s("th",{class:"text-left font-weight-bold"},"Source"),s("th",{class:"text-left font-weight-bold"},"Status"),s("th",{class:"text-left font-weight-bold"},"Score"),s("th",{class:"text-left font-weight-bold"},"Owner"),s("th",{class:"text-right font-weight-bold"},"Actions")])],-1)),s("tbody",null,[(m(!0),g($,null,R(f.leads.data,a=>(m(),g("tr",{key:a.id},[s("td",pe,[t(o(I),{href:i.route("crm.leads.show",a.id),class:"text-decoration-none text-high-emphasis"},{default:l(()=>[r(u(a.first_name)+" "+u(a.last_name),1)]),_:2},1032,["href"])]),s("td",null,u(a.email),1),s("td",null,u(a.company_name||"-"),1),s("td",null,u(a.source||"-"),1),s("td",null,[t(se,{color:Z(a.status),size:"small",variant:"tonal",class:"text-capitalize font-weight-medium",style:{"border-radius":"4px"}},{default:l(()=>[r(u(a.status),1)]),_:2},1032,["color"])]),s("td",null,[t(oe,{size:"28",color:a.score>=70?"success":a.score>=40?"warning":"error",class:"text-white text-caption font-weight-bold"},{default:l(()=>[r(u(a.score),1)]),_:2},1032,["color"])]),s("td",null,u(a.owner?.first_name||"N/A"),1),s("td",ge,[t(O,{location:"bottom end",transition:"scale-transition"},{activator:l(({props:d})=>[t(c,q({ref_for:!0},d,{icon:"mdi-dots-vertical",variant:"text",size:"small",color:"medium-emphasis"}),null,16)]),default:l(()=>[t(P,{density:"compact",width:"200"},{default:l(()=>[t(b,{onClick:d=>o(x).get(i.route("crm.leads.show",a.id)),"prepend-icon":"mdi-eye"},{default:l(()=>[t(y,null,{default:l(()=>[...e[23]||(e[23]=[r("View Details",-1)])]),_:1})]),_:1},8,["onClick"]),t(b,{onClick:d=>o(x).get(i.route("crm.leads.edit",a.id)),"prepend-icon":"mdi-pencil"},{default:l(()=>[t(y,null,{default:l(()=>[...e[24]||(e[24]=[r("Edit Lead",-1)])]),_:1})]),_:1},8,["onClick"]),t(L,{class:"my-1"}),t(re,{class:"text-uppercase font-weight-bold text-caption"},{default:l(()=>[...e[25]||(e[25]=[r("Move To / Status",-1)])]),_:1}),t(O,{location:"left start","open-on-hover":"",transition:"scale-transition"},{activator:l(({props:d})=>[t(b,q({ref_for:!0},d,{"prepend-icon":"mdi-swap-horizontal","append-icon":"mdi-chevron-right"}),{default:l(()=>[t(y,null,{default:l(()=>[...e[26]||(e[26]=[r("Change Status",-1)])]),_:1})]),_:1},16)]),default:l(()=>[t(P,{density:"compact",width:"150"},{default:l(()=>[(m(!0),g($,null,R(M.filter(d=>d.value!==""),d=>(m(),T(b,{key:d.value,onClick:we=>H(a,d.value),active:a.status===d.value},{default:l(()=>[t(y,null,{default:l(()=>[r(u(d.title),1)]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:2},1024)]),_:2},1024),a.status!=="converted"?(m(),T(b,{key:0,onClick:d=>Q(a),"prepend-icon":"mdi-account-convert",class:"text-success"},{default:l(()=>[t(y,null,{default:l(()=>[...e[27]||(e[27]=[r("Convert to Deal",-1)])]),_:1})]),_:1},8,["onClick"])):h("",!0),t(L,{class:"my-1"}),t(b,{onClick:d=>J(a.id),"prepend-icon":"mdi-delete",class:"text-error"},{default:l(()=>[t(y,null,{default:l(()=>[...e[28]||(e[28]=[r("Delete Lead",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]))),128)),f.leads.data.length===0?(m(),g("tr",Ve,[...e[29]||(e[29]=[s("td",{colspan:"8",class:"text-center py-8 text-medium-emphasis"},' No leads found. Click "New Lead" to get started. ',-1)])])):h("",!0)])]),_:1}),t(L),s("div",be,[t(ne,{modelValue:f.leads.current_page,"onUpdate:modelValue":[e[3]||(e[3]=a=>f.leads.current_page=a),e[4]||(e[4]=a=>o(x).get(i.route("crm.leads.index"),{page:a,search:C.value,status:w.value,source:k.value},{preserveState:!0}))],length:f.leads.last_page,size:"small","active-color":"primary"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(me,{modelValue:v.value,"onUpdate:modelValue":e[12]||(e[12]=a=>v.value=a),"max-width":"500px"},{default:l(()=>[t(j,null,{default:l(()=>[t(E,{class:"pa-4 border-bottom d-flex justify-space-between align-center"},{default:l(()=>[e[31]||(e[31]=s("span",{class:"text-h5 font-weight-bold"},"Convert Lead",-1)),t(c,{icon:"mdi-close",variant:"text",onClick:e[5]||(e[5]=a=>v.value=!1)})]),_:1}),t(B,{class:"pa-4"},{default:l(()=>[s("p",xe,[e[32]||(e[32]=r(" Convert ",-1)),s("strong",null,u(_.value?.first_name)+" "+u(_.value?.last_name),1),e[33]||(e[33]=r(" into a contact and optionally create a deal. ",-1))]),t(K,{modelValue:o(n).create_client,"onUpdate:modelValue":e[6]||(e[6]=a=>o(n).create_client=a),label:"Create Client/Company","hide-details":"",class:"mb-2"},null,8,["modelValue"]),t(K,{modelValue:o(n).create_deal,"onUpdate:modelValue":e[7]||(e[7]=a=>o(n).create_deal=a),label:"Create Deal","hide-details":"",class:"mb-4"},null,8,["modelValue"]),t(ie,null,{default:l(()=>[o(n).create_deal?(m(),g("div",ye,[t(N,{modelValue:o(n).deal_title,"onUpdate:modelValue":e[8]||(e[8]=a=>o(n).deal_title=a),label:"Deal Title",variant:"outlined",density:"comfortable",class:"mb-3","error-messages":o(n).errors.deal_title},null,8,["modelValue","error-messages"]),t(N,{modelValue:o(n).deal_value,"onUpdate:modelValue":e[9]||(e[9]=a=>o(n).deal_value=a),label:"Deal Value (GHS)",type:"number",variant:"outlined",density:"comfortable",class:"mb-3","error-messages":o(n).errors.deal_value},null,8,["modelValue","error-messages"]),t(U,{modelValue:o(n).deal_stage_id,"onUpdate:modelValue":e[10]||(e[10]=a=>o(n).deal_stage_id=a),items:f.dealStages,"item-title":"name","item-value":"id",label:"Deal Stage",variant:"outlined",density:"comfortable","error-messages":o(n).errors.deal_stage_id},null,8,["modelValue","items","error-messages"])])):h("",!0)]),_:1})]),_:1}),t(L),t(de,{class:"pa-4"},{default:l(()=>[t(ue),t(c,{variant:"text",onClick:e[11]||(e[11]=a=>v.value=!1)},{default:l(()=>[...e[34]||(e[34]=[r("Cancel",-1)])]),_:1}),t(c,{color:"success",onClick:W,loading:o(n).processing},{default:l(()=>[...e[35]||(e[35]=[r("Convert Lead",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},De=ce(Ce,[["__scopeId","data-v-6eb72ac4"]]);export{De as default};
