import{o as p,N as v,b as e,v as o,U as P,a as t,l as D,n as i,h as s,O as b,j as g,f as r,_ as w,a7 as y,p as N,q as U,g as j,a3 as B,D as _,a0 as $,a4 as O,T as L,X as z,S as d,Z as E,ah as q,c as G,a6 as H,s as K,t as k,$ as C,W as S,a8 as R,P as W,a9 as M}from"./app-CajJQkEm.js";import{_ as X}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CUimra8q.js";import{_ as Z}from"./LoaderWrapper-CM7phn5N.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-CbPhcYUv.js";const J={class:"d-flex gap-2"},Q={class:"font-weight-medium"},Y={class:"text-caption"},ee={key:1},te={class:"text-right"},le={key:0},ae={class:"pa-4 d-flex justify-center"},se={__name:"Index",props:{deals:{type:Object,required:!0},filters:Object,stages:Array},setup(u){const V=u,m=$ref(V.filters?.search||""),f=$ref(V.filters?.stage_id||""),c=$ref(V.filters?.status||""),h=()=>{y.get(route("crm.deals.index"),{search:m,stage_id:f,status:c},{preserveState:!0,replace:!0})},I=()=>{m="",f="",c="",h()},A=n=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(n),T=n=>n?new Date(n).toLocaleDateString():"N/A",F=n=>{confirm("Are you sure you want to delete this deal?")&&y.delete(window.route("crm.deals.destroy",n))};return(n,l)=>(p(),v(L,null,[e(o(P),{title:"Deals List"}),e(X,null,{default:t(()=>[e(D,null,{default:t(()=>[e(i,{cols:"12",class:"d-flex justify-space-between align-center"},{default:t(()=>[l[9]||(l[9]=s("div",null,[s("h2",{class:"text-h4 font-weight-bold"},"Deals List"),s("p",{class:"text-subtitle-1 text-medium-emphasis"},"Overview of all active and closed deals")],-1)),s("div",J,[e(o(b),{href:n.route("crm.deals.pipeline"),class:"text-decoration-none mr-2"},{default:t(()=>[e(g,{variant:"outlined",color:"primary"},{prepend:t(()=>[e(w,{name:"custom-row-vertical",style:{width:"18px",height:"18px"}})]),default:t(()=>[l[6]||(l[6]=r(" Pipeline View ",-1))]),_:1})]),_:1},8,["href"]),e(g,{variant:"outlined",color:"secondary",onClick:l[0]||(l[0]=a=>o(y).get(n.route("crm.deals.export"),{search:o(m),stage_id:o(f),status:o(c)}))},{prepend:t(()=>[e(w,{name:"custom-download",style:{width:"18px",height:"18px"}})]),default:t(()=>[l[7]||(l[7]=r(" Export CSV ",-1))]),_:1}),e(o(b),{href:n.route("crm.deals.create"),class:"text-decoration-none"},{default:t(()=>[e(g,{color:"primary"},{prepend:t(()=>[e(w,{name:"custom-plus",style:{width:"18px",height:"18px"}})]),default:t(()=>[l[8]||(l[8]=r(" New Deal ",-1))]),_:1})]),_:1},8,["href"])])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(N,{class:"mb-4"},{default:t(()=>[e(U,null,{default:t(()=>[e(D,null,{default:t(()=>[e(i,{cols:"12",md:"4"},{default:t(()=>[e(j,{modelValue:o(m),"onUpdate:modelValue":l[1]||(l[1]=a=>_(m)?m.value=a:null),label:"Search deals...","prepend-inner-icon":"mdi-magnify","hide-details":"",variant:"outlined",density:"comfortable",onKeyup:B(h,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"3"},{default:t(()=>[e($,{modelValue:o(f),"onUpdate:modelValue":l[2]||(l[2]=a=>_(f)?f.value=a:null),items:[{title:"All Stages",value:""},...u.stages.map(a=>({title:a.name,value:a.id}))],label:"Stage","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",md:"3"},{default:t(()=>[e($,{modelValue:o(c),"onUpdate:modelValue":l[3]||(l[3]=a=>_(c)?c.value=a:null),items:[{title:"All Statuses",value:""},{title:"Open",value:"open"},{title:"Won",value:"won"},{title:"Lost",value:"lost"}],label:"Status","hide-details":"",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:t(()=>[e(g,{color:"primary",block:"",flat:"",onClick:h},{default:t(()=>[...l[10]||(l[10]=[r("Filter",-1)])]),_:1}),e(g,{variant:"outlined",block:"",onClick:I},{default:t(()=>[...l[11]||(l[11]=[r("Clear",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(N,{variant:"flat"},{default:t(()=>[e(O,{hover:""},{default:t(()=>[l[16]||(l[16]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Title"),s("th",{class:"text-left"},"Stage"),s("th",{class:"text-left"},"Value"),s("th",{class:"text-left"},"Probability"),s("th",{class:"text-left"},"Contact"),s("th",{class:"text-left"},"Expected Close"),s("th",{class:"text-right"},"Actions")])],-1)),s("tbody",null,[(p(!0),v(L,null,z(u.deals.data,a=>(p(),v("tr",{key:a.id},[s("td",Q,d(a.title),1),s("td",null,[e(E,{size:"small",color:a.stage?.color||"primary",variant:"tonal"},{default:t(()=>[r(d(a.stage?.name||"Unknown"),1)]),_:2},1032,["color"])]),s("td",null,d(A(a.value)),1),s("td",null,[e(q,{"model-value":a.probability,color:a.stage?.color||"primary",height:"8",rounded:""},null,8,["model-value","color"]),s("span",Y,d(a.probability)+"%",1)]),s("td",null,[a.contact?(p(),G(o(b),{key:0,href:n.route("crm.contacts.show",a.contact.id),class:"text-primary text-decoration-none font-weight-medium"},{default:t(()=>[r(d(a.contact.first_name)+" "+d(a.contact.last_name),1)]),_:2},1032,["href"])):(p(),v("span",ee,d(a.contact_name||"N/A"),1))]),s("td",null,d(T(a.expected_close_date)),1),s("td",te,[e(H,null,{activator:t(({props:x})=>[e(g,R({icon:"mdi-dots-vertical",variant:"text",size:"small"},{ref_for:!0},x),null,16)]),default:t(()=>[e(K,{size:"small"},{default:t(()=>[e(k,{onClick:x=>o(y).get(n.route("crm.deals.show",a.id))},{prepend:t(()=>[e(S,{icon:"mdi-eye-outline"})]),default:t(()=>[e(C,null,{default:t(()=>[...l[12]||(l[12]=[r("View Details",-1)])]),_:1})]),_:1},8,["onClick"]),e(k,{onClick:x=>o(y).get(n.route("crm.deals.edit",a.id))},{prepend:t(()=>[e(S,{icon:"mdi-pencil-outline"})]),default:t(()=>[e(C,null,{default:t(()=>[...l[13]||(l[13]=[r("Edit",-1)])]),_:1})]),_:1},8,["onClick"]),e(k,{onClick:x=>F(a.id),"base-color":"error"},{prepend:t(()=>[e(S,{icon:"mdi-delete-outline"})]),default:t(()=>[e(C,null,{default:t(()=>[...l[14]||(l[14]=[r("Delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]))),128)),u.deals.data.length===0?(p(),v("tr",le,[...l[15]||(l[15]=[s("td",{colspan:"7",class:"text-center py-8 text-medium-emphasis"}," No deals found. Start by creating a new deal! ",-1)])])):W("",!0)])]),_:1})]),_:1})]),_:1}),e(i,{cols:"12"},{default:t(()=>[s("div",ae,[e(M,{modelValue:u.deals.current_page,"onUpdate:modelValue":[l[4]||(l[4]=a=>u.deals.current_page=a),l[5]||(l[5]=a=>o(y).get(n.route("crm.deals.index"),{page:a,search:o(m),stage_id:o(f),status:o(c)},{preserveState:!0}))],length:u.deals.last_page,size:"small","active-color":"primary"},null,8,["modelValue","length"])])]),_:1})]),_:1})]),_:1})],64))}},de=Z(se,[["__scopeId","data-v-02def68d"]]);export{de as default};
