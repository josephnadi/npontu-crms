import{r as w,D as H,o as u,M as c,b as e,u as V,T as R,a as t,k as q,m as b,n as h,p as k,a2 as C,_ as m,h as l,R as o,ab as P,ad as W,g as Y,$ as Z,a4 as G,S as T,W as z,Y as D,f as r,N as J,aj as K,q as Q,s as f,Z as g,U as p,c as E,O as L,i as $,a7 as X,v as ee,a8 as v}from"./app-CqcLQhWc.js";import{_ as te}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{d as ae}from"./debounce-CSqvcByx.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const le={class:"text-h5 font-weight-bold"},se={class:"text-h5 font-weight-bold"},ne={class:"text-h5 font-weight-bold"},re={class:"d-flex",style:{gap:"12px"}},oe={class:"font-weight-medium"},ie={class:"text-caption text-medium-emphasis text-truncate",style:{"max-width":"200px"}},ue={class:"text-right"},de={key:0},ce={class:"pa-4 d-flex align-center justify-space-between"},me={class:"text-caption text-medium-emphasis"},fe={class:"d-flex",style:{gap:"8px"}},he={__name:"Index",props:{engagements:{type:Object,required:!0},filters:Object,stats:Object},setup(i){const S=i,x=w(S.filters?.search||""),y=w(S.filters?.type||"all"),_=w(!1),N=()=>{_.value=!0,v.get(route("crm.engagements.index"),{search:x.value,type:y.value},{preserveState:!0,replace:!0,preserveScroll:!0,onStart:()=>_.value=!0,onFinish:()=>_.value=!1})};H([x,y],ae(()=>{N()},500));const j=n=>{confirm("Are you sure you want to delete this engagement?")&&v.delete(route("crm.engagements.destroy",n))},A=n=>{confirm("Convert this engagement to a new Deal?")&&v.post(route("crm.engagements.convert-to-deal",n))},M=n=>{confirm("Create a support ticket from this engagement?")&&v.post(route("crm.engagements.convert-to-ticket",n))},B=n=>{switch(n){case"email":return"custom-mail";case"call":return"custom-phone";case"meeting":return"custom-users";case"webinar":return"custom-video";case"form_submitted":return"custom-file-text";case"content_viewed":return"custom-eye";default:return"custom-calendar"}},F=n=>{switch(n){case"email":return"warning";case"call":return"info";case"meeting":return"primary";case"webinar":return"secondary";case"form_submitted":return"success";case"content_viewed":return"info";default:return"grey"}},I=n=>n?new Date(n).toLocaleString():"N/A",U=n=>{if(!n.engageable)return"#";switch(n.engageable_type.split("\\").pop().toLowerCase()){case"deal":return route("crm.deals.show",n.engageable_id);case"lead":return route("crm.leads.show",n.engageable_id);case"contact":return route("crm.contacts.show",n.engageable_id);case"client":return route("crm.clients.show",n.engageable_id);default:return"#"}},O=n=>{if(!n.engageable)return"Unknown";const a=n.engageable_type.split("\\").pop(),s=n.engageable.name||n.engageable.full_name||n.engageable.title||"Unknown";return`${a}: ${s}`};return(n,a)=>(u(),c(T,null,[e(V(R),{title:"Engagements"}),e(te,null,{default:t(()=>[e(q,null,{default:t(()=>[e(b,{cols:"12",md:"4"},{default:t(()=>[e(h,{variant:"outlined",class:"bg-surface"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(C,{color:"primary",variant:"tonal",size:"40",class:"mr-3"},{default:t(()=>[e(m,{name:"custom-calendar",size:"20"})]),_:1}),l("div",null,[a[2]||(a[2]=l("div",{class:"text-subtitle-2 text-medium-emphasis"},"Total Engagements",-1)),l("div",le,o(i.stats.total),1)])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12",md:"4"},{default:t(()=>[e(h,{variant:"outlined",class:"bg-surface"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(C,{color:"success",variant:"tonal",size:"40",class:"mr-3"},{default:t(()=>[e(m,{name:"custom-trending-up",size:"20"})]),_:1}),l("div",null,[a[3]||(a[3]=l("div",{class:"text-subtitle-2 text-medium-emphasis"},"This Month",-1)),l("div",se,o(i.stats.this_month),1)])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12",md:"4"},{default:t(()=>[e(h,{variant:"outlined",class:"bg-surface"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(C,{color:"warning",variant:"tonal",size:"40",class:"mr-3"},{default:t(()=>[e(m,{name:"custom-star",size:"20"})]),_:1}),l("div",null,[a[4]||(a[4]=l("div",{class:"text-subtitle-2 text-medium-emphasis"},"Avg. Engagement Score",-1)),l("div",ne,o(i.stats.avg_score),1)])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(h,{variant:"outlined",class:"bg-surface"},{default:t(()=>[e(P,{class:"pa-4 d-flex align-center"},{default:t(()=>[a[5]||(a[5]=l("span",null,"Engagement History",-1)),e(W),l("div",re,[e(Y,{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=s=>x.value=s),"prepend-inner-icon":"mdi-magnify",label:"Search",variant:"outlined",density:"compact","hide-details":"",style:{width:"250px"}},null,8,["modelValue"]),e(Z,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=s=>y.value=s),items:["all","email","call","meeting","webinar","form_submitted","content_viewed","other"],label:"Type",variant:"outlined",density:"compact","hide-details":"",style:{width:"150px"}},null,8,["modelValue"])])]),_:1}),e(G,null,{default:t(()=>[a[17]||(a[17]=l("thead",null,[l("tr",null,[l("th",{class:"text-left"},"Type"),l("th",{class:"text-left"},"Subject"),l("th",{class:"text-left"},"Related To"),l("th",{class:"text-left"},"Date"),l("th",{class:"text-left"},"Score"),l("th",{class:"text-right"},"Actions")])],-1)),l("tbody",null,[(u(!0),c(T,null,z(i.engagements.data,s=>(u(),c("tr",{key:s.id},[l("td",null,[e(D,{color:F(s.type),size:"small",variant:"tonal"},{prepend:t(()=>[e(m,{name:B(s.type),size:"14",class:"mr-1"},null,8,["name"])]),default:t(()=>[r(" "+o(s.type),1)]),_:2},1032,["color"])]),l("td",null,[l("div",oe,o(s.subject),1),l("div",ie,o(s.description),1)]),l("td",null,[e(V(J),{href:U(s),class:"text-decoration-none text-primary"},{default:t(()=>[r(o(O(s)),1)]),_:2},1032,["href"])]),l("td",null,o(I(s.engagement_date)),1),l("td",null,[e(D,{color:s.score>=50?"success":"grey",size:"x-small"},{default:t(()=>[r(o(s.score),1)]),_:2},1032,["color"])]),l("td",ue,[e(K,null,{activator:t(({props:d})=>[e($,X({size:"small"},{ref_for:!0},d,{variant:"text"}),{default:t(()=>[e(p,{color:"primary"},{default:t(()=>[...a[6]||(a[6]=[r("mdi-pencil",-1)])]),_:1})]),_:1},16)]),default:t(()=>[e(Q,null,{default:t(()=>[e(f,{to:n.route("crm.engagements.show",s.id)},{prepend:t(()=>[e(p,null,{default:t(()=>[...a[7]||(a[7]=[r("mdi-eye",-1)])]),_:1})]),default:t(()=>[e(g,null,{default:t(()=>[...a[8]||(a[8]=[r("View Details",-1)])]),_:1})]),_:1},8,["to"]),e(f,{to:n.route("crm.engagements.edit",s.id)},{prepend:t(()=>[e(p,null,{default:t(()=>[...a[9]||(a[9]=[r("mdi-pencil",-1)])]),_:1})]),default:t(()=>[e(g,null,{default:t(()=>[...a[10]||(a[10]=[r("Edit Engagement",-1)])]),_:1})]),_:1},8,["to"]),s.engageable_type!=="App\\Models\\Deal"?(u(),E(f,{key:0,onClick:d=>A(s.id)},{prepend:t(()=>[e(p,null,{default:t(()=>[...a[11]||(a[11]=[r("mdi-handshake-outline",-1)])]),_:1})]),default:t(()=>[e(g,null,{default:t(()=>[...a[12]||(a[12]=[r("Convert to Deal",-1)])]),_:1})]),_:1},8,["onClick"])):L("",!0),e(f,{onClick:d=>M(s.id)},{prepend:t(()=>[e(p,null,{default:t(()=>[...a[13]||(a[13]=[r("mdi-ticket-outline",-1)])]),_:1})]),default:t(()=>[e(g,null,{default:t(()=>[...a[14]||(a[14]=[r("Convert to Ticket",-1)])]),_:1})]),_:1},8,["onClick"]),e(f,{onClick:d=>j(s.id)},{prepend:t(()=>[e(m,{name:"custom-trash",size:"18"})]),default:t(()=>[e(g,null,{default:t(()=>[...a[15]||(a[15]=[r("Delete Engagement",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]))),128)),i.engagements.data.length===0?(u(),c("tr",de,[...a[16]||(a[16]=[l("td",{colspan:"6",class:"text-center pa-8 text-medium-emphasis"}," No engagements found. ",-1)])])):L("",!0)])]),_:1}),e(ee),l("div",ce,[l("div",me," Showing "+o(i.engagements.from||0)+" to "+o(i.engagements.to||0)+" of "+o(i.engagements.total)+" engagements ",1),l("div",fe,[(u(!0),c(T,null,z(i.engagements.links,s=>(u(),E($,{key:s.label,disabled:!s.url||s.active,variant:"outlined",size:"small",onClick:d=>V(v).get(s.url),innerHTML:s.label},null,8,["disabled","onClick","innerHTML"]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{he as default};
