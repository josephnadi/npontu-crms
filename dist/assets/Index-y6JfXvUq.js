import{_ as X}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import{d as ee,r as f,D as te,j as le,o as c,M as k,b as l,a as t,m,n as w,h as s,a2 as A,U as u,f as o,R as d,k as V,g as se,ar as ae,$ as I,i as x,a4 as oe,O as g,S as U,W as de,c as y,a9 as ie,u as ne,a8 as b,ab as re,p as ue,Y as N,v as me,ac as ce,ad as fe,aa as ve,F as O,aj as pe,q as xe,s as h,Z as S,a7 as ge,ax as be,ay as ye}from"./app-CqcLQhWc.js";import{l as _e}from"./lodash-CdjocJhF.js";import{_ as Ce}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-Bl_MKtEy.js";import{_ as ke}from"./UiParentCard.vue_vue_type_script_setup_true_lang-Drb8UaWj.js";import{L as we}from"./LeadConversionModal-tKN_JP7h.js";import{_ as Ve}from"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const he={class:"d-flex align-center"},Se={class:"text-h5 font-weight-bold"},Le={class:"d-flex align-center"},ze={class:"text-h5 font-weight-bold"},$e={class:"d-flex align-center"},Te={class:"text-h5 font-weight-bold"},Ae={class:"d-flex align-center"},Ne={class:"text-h5 font-weight-bold"},Fe={class:"table-responsive"},Me={key:0},Pe={class:"font-weight-medium"},je={class:"text-caption text-medium-emphasis"},De={class:"text-center"},Ie={class:"text-right"},Ue={class:"d-flex justify-end gap-1"},Oe={class:"text-body-2 text-medium-emphasis"},qe={class:"mb-4"},Be={class:"text-body-1 font-weight-medium"},Ee={class:"mb-4"},Re={class:"text-body-1"},Qe={class:"mb-4"},Ke={class:"text-body-1"},We={class:"mb-4"},Ye={class:"text-body-1"},Ze={class:"mb-4"},Ge={class:"mb-4"},He={key:0},Je={class:"text-body-2 pa-3 bg-grey-lighten-4 rounded"},Xe=ee({__name:"LeadIndex",props:{leads:{default:()=>({data:[],from:0,to:0,total:0,current_page:1,last_page:1})},leadSources:{default:()=>[]},filters:{default:()=>({})},stats:{default:()=>({})},dealStages:{default:()=>[]}},setup(n){const v=n,P=f("Leads"),q=f([{title:"CRM",disabled:!1,href:"#"},{title:"Leads",disabled:!0,href:"#"}]),L=f(v.filters.search||""),z=f(v.filters.status||""),$=f(v.filters.lead_source_id||""),j=f(!1),B=[{value:"",text:"All Statuses"},{value:"new",text:"New"},{value:"contacted",text:"Contacted"},{value:"qualified",text:"Qualified"},{value:"converted",text:"Converted"},{value:"lost",text:"Lost"}],D=i=>({new:"info",contacted:"warning",qualified:"purple",converted:"success",lost:"error"})[i]||"default",F=()=>{j.value=!0,b.get(route("crm.leads.index"),{search:L.value,status:z.value,lead_source_id:$.value},{preserveState:!0,preserveScroll:!0,onFinish:()=>j.value=!1})},E=()=>{b.visit(route("crm.leads.create"))},_=f(!1),r=f(null),R=i=>{r.value=i,_.value=!0},Q=i=>{b.visit(route("crm.leads.edit",{id:i}))},K=(i,e)=>{confirm(`Are you sure you want to delete lead "${e}"?`)&&b.delete(route("crm.leads.destroy",i),{preserveScroll:!0})},T=f(!1),C=f(null),W=i=>{C.value=i,T.value=!0},Y=()=>{T.value=!1,C.value=null},Z=i=>{confirm("Convert this lead to a Partner?")&&b.post(route("crm.leads.convert-to-partner",{id:i}))},G=i=>{confirm("Create a support ticket for this lead?")&&b.post(route("crm.leads.convert-to-ticket",{id:i}))},H=O(()=>[{value:"",text:"All Sources"},...v.leadSources.map(i=>({value:i.id,text:i.name}))]),M=O(()=>v.leads?.data||[]);return te([L,z,$],_e.debounce(()=>{F()},500)),(i,e)=>{const J=le("Link");return c(),k(U,null,[l(Ce,{title:P.value,breadcrumbs:q.value},null,8,["title","breadcrumbs"]),l(V,{class:"mb-4"},{default:t(()=>[l(m,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(w,{elevation:"0",class:"bg-lightprimary pa-4 rounded-lg"},{default:t(()=>[s("div",he,[l(A,{color:"primary",size:"40",class:"mr-3"},{default:t(()=>[l(u,{color:"white"},{default:t(()=>[...e[9]||(e[9]=[o("mdi-account-group",-1)])]),_:1})]),_:1}),s("div",null,[e[10]||(e[10]=s("div",{class:"text-subtitle-2 text-medium-emphasis"},"Total Leads",-1)),s("div",Se,d(n.stats.total||0),1)])])]),_:1})]),_:1}),l(m,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(w,{elevation:"0",class:"bg-lightinfo pa-4 rounded-lg"},{default:t(()=>[s("div",Le,[l(A,{color:"info",size:"40",class:"mr-3"},{default:t(()=>[l(u,{color:"white"},{default:t(()=>[...e[11]||(e[11]=[o("mdi-account-plus",-1)])]),_:1})]),_:1}),s("div",null,[e[12]||(e[12]=s("div",{class:"text-subtitle-2 text-medium-emphasis"},"New Leads",-1)),s("div",ze,d(n.stats.new||0),1)])])]),_:1})]),_:1}),l(m,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(w,{elevation:"0",class:"bg-lightwarning pa-4 rounded-lg"},{default:t(()=>[s("div",$e,[l(A,{color:"warning",size:"40",class:"mr-3"},{default:t(()=>[l(u,{color:"white"},{default:t(()=>[...e[13]||(e[13]=[o("mdi-account-check",-1)])]),_:1})]),_:1}),s("div",null,[e[14]||(e[14]=s("div",{class:"text-subtitle-2 text-medium-emphasis"},"Qualified",-1)),s("div",Te,d(n.stats.qualified||0),1)])])]),_:1})]),_:1}),l(m,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(w,{elevation:"0",class:"bg-lightsuccess pa-4 rounded-lg"},{default:t(()=>[s("div",Ae,[l(A,{color:"success",size:"40",class:"mr-3"},{default:t(()=>[l(u,{color:"white"},{default:t(()=>[...e[15]||(e[15]=[o("mdi-account-convert",-1)])]),_:1})]),_:1}),s("div",null,[e[16]||(e[16]=s("div",{class:"text-subtitle-2 text-medium-emphasis"},"Converted",-1)),s("div",Ne,d(n.stats.converted||0),1)])])]),_:1})]),_:1})]),_:1}),l(V,null,{default:t(()=>[l(m,{cols:"12"},{default:t(()=>[l(ke,{title:"Leads Management"},{action:t(()=>[l(x,{color:"primary",onClick:E},{default:t(()=>[l(u,{left:"",class:"mr-1"},{default:t(()=>[...e[17]||(e[17]=[o("mdi-plus",-1)])]),_:1}),e[18]||(e[18]=o(" New Lead ",-1))]),_:1})]),default:t(()=>[l(V,{class:"mb-4"},{default:t(()=>[l(m,{cols:"12",md:"4"},{default:t(()=>[l(se,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=a=>L.value=a),label:"Search",placeholder:"Search by name, email, company...",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-magnify",clearable:"","hide-details":"",onKeyup:ae(F,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{cols:"12",md:"3"},{default:t(()=>[l(I,{modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=a=>z.value=a),items:B,"item-title":"text","item-value":"value",label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),l(m,{cols:"12",md:"3"},{default:t(()=>[l(I,{modelValue:$.value,"onUpdate:modelValue":e[2]||(e[2]=a=>$.value=a),items:H.value,"item-title":"text","item-value":"value",label:"Source",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"12",md:"2",class:"d-flex gap-2"},{default:t(()=>[l(x,{color:"primary",onClick:F,block:"",height:"48"},{default:t(()=>[...e[19]||(e[19]=[o(" Filter ",-1)])]),_:1})]),_:1})]),_:1}),s("div",Fe,[l(oe,null,{default:t(()=>[e[34]||(e[34]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Name"),s("th",{class:"text-left"},"Company"),s("th",{class:"text-left"},"Source"),s("th",{class:"text-center"},"Score"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-center"},"Actions")])],-1)),s("tbody",null,[M.value.length===0?(c(),k("tr",Me,[...e[20]||(e[20]=[s("td",{colspan:"6",class:"text-center py-8"},[s("div",{class:"text-h6 text-medium-emphasis"},"No leads found")],-1)])])):g("",!0),(c(!0),k(U,null,de(M.value,a=>(c(),k("tr",{key:a.id},[s("td",null,[s("div",Pe,d(a.full_name),1),s("div",je,d(a.email),1)]),s("td",null,d(a.company_name||"-"),1),s("td",null,d(a.lead_source?.name||"-"),1),s("td",De,[l(N,{color:a.score>=70?"success":a.score>=40?"warning":"default",size:"small",variant:"flat"},{default:t(()=>[o(d(a.score),1)]),_:2},1032,["color"])]),s("td",null,[l(N,{color:D(a.status),size:"small",label:""},{default:t(()=>[o(d(a.status.charAt(0).toUpperCase()+a.status.slice(1)),1)]),_:2},1032,["color"])]),s("td",Ie,[s("div",Ue,[l(x,{size:"small",icon:"",variant:"text",onClick:p=>R(a),title:"Quick View"},{default:t(()=>[l(u,{color:"info"},{default:t(()=>[...e[21]||(e[21]=[o("mdi-eye",-1)])]),_:1})]),_:1},8,["onClick"]),l(pe,null,{activator:t(({props:p})=>[l(x,ge({size:"small",icon:"",variant:"text"},{ref_for:!0},p,{title:"Edit & Actions"}),{default:t(()=>[l(u,{color:"primary"},{default:t(()=>[...e[22]||(e[22]=[o("mdi-pencil",-1)])]),_:1})]),_:1},16)]),default:t(()=>[l(xe,{density:"compact"},{default:t(()=>[l(h,{onClick:p=>Q(a.id),value:"edit"},{prepend:t(()=>[l(u,{size:"small",class:"mr-2"},{default:t(()=>[...e[23]||(e[23]=[o("mdi-pencil",-1)])]),_:1})]),default:t(()=>[l(S,null,{default:t(()=>[...e[24]||(e[24]=[o("Edit Lead",-1)])]),_:1})]),_:1},8,["onClick"]),l(J,{href:i.route("crm.leads.show",a.id),class:"text-decoration-none text-high-emphasis"},{default:t(()=>[l(h,{value:"details"},{prepend:t(()=>[l(u,{size:"small",class:"mr-2"},{default:t(()=>[...e[25]||(e[25]=[o("mdi-file-document-outline",-1)])]),_:1})]),default:t(()=>[l(S,null,{default:t(()=>[...e[26]||(e[26]=[o("Full Details",-1)])]),_:1})]),_:1})]),_:1},8,["href"]),a.status==="qualified"?(c(),y(h,{key:0,onClick:p=>W(a),value:"convert-client"},{prepend:t(()=>[l(u,{size:"small",class:"mr-2"},{default:t(()=>[...e[27]||(e[27]=[o("mdi-account-convert",-1)])]),_:1})]),default:t(()=>[l(S,null,{default:t(()=>[...e[28]||(e[28]=[o("Convert to Client",-1)])]),_:1})]),_:1},8,["onClick"])):g("",!0),a.status!=="converted"?(c(),y(h,{key:1,onClick:p=>Z(a.id),value:"convert-partner"},{prepend:t(()=>[l(u,{size:"small",class:"mr-2"},{default:t(()=>[...e[29]||(e[29]=[o("mdi-handshake-outline",-1)])]),_:1})]),default:t(()=>[l(S,null,{default:t(()=>[...e[30]||(e[30]=[o("Convert to Partner",-1)])]),_:1})]),_:1},8,["onClick"])):g("",!0),l(h,{onClick:p=>G(a.id),value:"convert-ticket"},{prepend:t(()=>[l(u,{size:"small",class:"mr-2"},{default:t(()=>[...e[31]||(e[31]=[o("mdi-ticket-outline",-1)])]),_:1})]),default:t(()=>[l(S,null,{default:t(()=>[...e[32]||(e[32]=[o("Convert to Ticket",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024),l(x,{size:"small",icon:"",variant:"text",onClick:p=>K(a.id,a.full_name),title:"Delete"},{default:t(()=>[l(u,{color:"error"},{default:t(()=>[...e[33]||(e[33]=[o("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])])])]))),128))])]),_:1})]),M.value.length>0?(c(),y(V,{key:0,class:"mt-4"},{default:t(()=>[l(m,{cols:"12",class:"d-flex justify-space-between align-center"},{default:t(()=>[s("div",Oe," Showing "+d(n.leads.from)+" to "+d(n.leads.to)+" of "+d(n.leads.total)+" leads ",1),l(ie,{modelValue:n.leads.current_page,"onUpdate:modelValue":[e[3]||(e[3]=a=>n.leads.current_page=a),e[4]||(e[4]=a=>ne(b).get(i.route("crm.leads.index"),{...n.filters,page:a}))],length:n.leads.last_page,"total-visible":5,density:"comfortable"},null,8,["modelValue","length"])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1}),l(ve,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=a=>_.value=a),"max-width":"800px"},{default:t(()=>[r.value?(c(),y(w,{key:0},{default:t(()=>[l(re,{class:"d-flex align-center justify-space-between pa-4 bg-primary"},{default:t(()=>[e[35]||(e[35]=s("span",{class:"text-h5 text-white"},"Lead Details",-1)),l(x,{icon:"mdi-close",variant:"text",color:"white",onClick:e[5]||(e[5]=a=>_.value=!1)})]),_:1}),l(ue,{class:"pa-6"},{default:t(()=>[l(V,null,{default:t(()=>[l(m,{cols:"12",md:"6"},{default:t(()=>[e[39]||(e[39]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-4 text-primary"},"Personal Information",-1)),s("div",qe,[e[36]||(e[36]=s("div",{class:"text-caption text-grey-darken-1"},"Full Name",-1)),s("div",Be,d(r.value.full_name),1)]),s("div",Ee,[e[37]||(e[37]=s("div",{class:"text-caption text-grey-darken-1"},"Email",-1)),s("div",Re,d(r.value.email||"-"),1)]),s("div",Qe,[e[38]||(e[38]=s("div",{class:"text-caption text-grey-darken-1"},"Phone",-1)),s("div",Ke,d(r.value.phone||"-"),1)])]),_:1}),l(m,{cols:"12",md:"6"},{default:t(()=>[e[43]||(e[43]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-4 text-primary"},"Company & Status",-1)),s("div",We,[e[40]||(e[40]=s("div",{class:"text-caption text-grey-darken-1"},"Company",-1)),s("div",Ye,d(r.value.company_name||"-"),1)]),s("div",Ze,[e[41]||(e[41]=s("div",{class:"text-caption text-grey-darken-1"},"Status",-1)),l(N,{color:D(r.value.status),size:"small",label:""},{default:t(()=>[o(d(r.value.status.charAt(0).toUpperCase()+r.value.status.slice(1)),1)]),_:1},8,["color"])]),s("div",Ge,[e[42]||(e[42]=s("div",{class:"text-caption text-grey-darken-1"},"Score",-1)),l(N,{color:r.value.score>=70?"success":"warning",size:"small"},{default:t(()=>[o(d(r.value.score)+"/100 ",1)]),_:1},8,["color"])])]),_:1})]),_:1}),l(me,{class:"my-4"}),r.value.notes?(c(),k("div",He,[e[44]||(e[44]=s("h3",{class:"text-subtitle-1 font-weight-bold mb-2 text-primary"},"Notes",-1)),s("div",Je,d(r.value.notes),1)])):g("",!0)]),_:1}),l(ce,{class:"pa-4"},{default:t(()=>[l(fe),l(x,{color:"primary",variant:"elevated",onClick:e[6]||(e[6]=a=>_.value=!1)},{default:t(()=>[...e[45]||(e[45]=[o("Close",-1)])]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1},8,["modelValue"]),C.value?(c(),y(we,{key:0,show:T.value,lead:C.value,"deal-stages":n.dealStages,onClose:e[8]||(e[8]=a=>{T.value=!1,C.value=null}),onConverted:Y},null,8,["show","lead","deal-stages"])):g("",!0)],64)}}}),et=Ve(Xe,[["__scopeId","data-v-68de1fbb"]]),ut={__name:"Index",props:{leads:Object,leadSources:Array,filters:Object,stats:Object,dealStages:Array},setup(n){return(v,P)=>(c(),y(X,null,{default:t(()=>[l(et,be(ye(v.$props)),null,16)]),_:1}))}};export{ut as default};
