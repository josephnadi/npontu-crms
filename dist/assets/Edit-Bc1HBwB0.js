import{L as $,o as _,M as b,b as e,u as i,T as N,a as o,l as A,k as y,m as r,n as C,p as j,i as c,h as s,R as p,v as g,V as B,w as E,g as m,$ as w,f as x,a4 as M,S as k,W as z,a1 as O,ac as P,ad as L,F as U}from"./app-CqcLQhWc.js";import{_ as R}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const Q={class:"text-h5 mb-0"},W={class:"mt-8 mb-4 d-flex align-center justify-space-between"},G={class:"py-2"},H={class:"py-2"},J={class:"py-2"},K={class:"py-2 font-weight-bold"},X={class:"py-2 text-right"},Y={class:"d-flex justify-space-between mb-2"},Z={class:"font-weight-bold"},ee={class:"d-flex justify-space-between mb-2"},te={class:"font-weight-bold"},le={class:"d-flex justify-space-between text-h6 primary--text"},se={class:"font-weight-bold"},re={__name:"Edit",props:{invoice:Object,clients:Array,projects:Array},setup(v){const d=v,l=$({invoice_number:d.invoice.invoice_number,client_id:d.invoice.client_id,project_id:d.invoice.project_id,issue_date:d.invoice.issue_date.split("T")[0],due_date:d.invoice.due_date.split("T")[0],status:d.invoice.status,notes:d.invoice.notes||"",items:d.invoice.items.map(n=>({description:n.description,quantity:parseFloat(n.quantity),unit_price:parseFloat(n.unit_price)}))}),I=[{title:"Draft",value:"draft"},{title:"Sent",value:"sent"},{title:"Paid",value:"paid"},{title:"Overdue",value:"overdue"},{title:"Cancelled",value:"cancelled"}],T=()=>{l.items.push({description:"",quantity:1,unit_price:0})},S=n=>{l.items.length>1&&l.items.splice(n,1)},V=U(()=>l.items.reduce((n,t)=>n+t.quantity*t.unit_price,0)),h=U(()=>V.value*.1),D=U(()=>V.value+h.value),f=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),F=()=>{l.put(route("crm.invoices.update",d.invoice.id))};return(n,t)=>(_(),b(k,null,[e(i(N),{title:"Edit Invoice"}),e(R,null,{default:o(()=>[e(A,{fluid:""},{default:o(()=>[e(y,{justify:"center"},{default:o(()=>[e(r,{cols:"12",lg:"10"},{default:o(()=>[e(C,{elevation:"0"},{default:o(()=>[e(j,{class:"d-flex align-center py-4"},{default:o(()=>[e(c,{icon:"mdi-arrow-left",variant:"text",class:"mr-2",onClick:t[0]||(t[0]=a=>n.$window.history.back())}),s("div",null,[s("h1",Q,"Edit Invoice: "+p(v.invoice.invoice_number),1)])]),_:1}),e(g),e(B,{onSubmit:E(F,["prevent"])},{default:o(()=>[e(j,{class:"pa-6"},{default:o(()=>[e(y,null,{default:o(()=>[e(r,{cols:"12",md:"4"},{default:o(()=>[e(m,{modelValue:i(l).invoice_number,"onUpdate:modelValue":t[1]||(t[1]=a=>i(l).invoice_number=a),label:"Invoice Number",variant:"outlined","error-messages":i(l).errors.invoice_number,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(w,{modelValue:i(l).client_id,"onUpdate:modelValue":t[2]||(t[2]=a=>i(l).client_id=a),items:v.clients,"item-title":"name","item-value":"id",label:"Client",variant:"outlined","error-messages":i(l).errors.client_id,required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(w,{modelValue:i(l).project_id,"onUpdate:modelValue":t[3]||(t[3]=a=>i(l).project_id=a),items:v.projects,"item-title":"name","item-value":"id",label:"Project (Optional)",variant:"outlined",clearable:"","error-messages":i(l).errors.project_id},null,8,["modelValue","items","error-messages"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(m,{modelValue:i(l).issue_date,"onUpdate:modelValue":t[4]||(t[4]=a=>i(l).issue_date=a),label:"Issue Date",type:"date",variant:"outlined","error-messages":i(l).errors.issue_date,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(m,{modelValue:i(l).due_date,"onUpdate:modelValue":t[5]||(t[5]=a=>i(l).due_date=a),label:"Due Date",type:"date",variant:"outlined","error-messages":i(l).errors.due_date,required:""},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",md:"4"},{default:o(()=>[e(w,{modelValue:i(l).status,"onUpdate:modelValue":t[6]||(t[6]=a=>i(l).status=a),items:I,label:"Status",variant:"outlined","error-messages":i(l).errors.status,required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),s("div",W,[t[10]||(t[10]=s("h3",{class:"text-h6"},"Invoice Items",-1)),e(c,{color:"secondary",variant:"outlined","prepend-icon":"mdi-plus",size:"small",onClick:T},{default:o(()=>[...t[9]||(t[9]=[x(" Add Item ",-1)])]),_:1})]),e(M,{class:"mb-6 border rounded"},{default:o(()=>[t[11]||(t[11]=s("thead",null,[s("tr",null,[s("th",{class:"text-left",style:{width:"50%"}},"Description"),s("th",{class:"text-left",style:{width:"15%"}},"Quantity"),s("th",{class:"text-left",style:{width:"15%"}},"Unit Price"),s("th",{class:"text-left",style:{width:"15%"}},"Total"),s("th",{class:"text-right",style:{width:"5%"}})])],-1)),s("tbody",null,[(_(!0),b(k,null,z(i(l).items,(a,q)=>(_(),b("tr",{key:q},[s("td",G,[e(m,{modelValue:a.description,"onUpdate:modelValue":u=>a.description=u,variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",H,[e(m,{modelValue:a.quantity,"onUpdate:modelValue":u=>a.quantity=u,modelModifiers:{number:!0},type:"number",variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",J,[e(m,{modelValue:a.unit_price,"onUpdate:modelValue":u=>a.unit_price=u,modelModifiers:{number:!0},type:"number",variant:"outlined",density:"compact","hide-details":"",required:""},null,8,["modelValue","onUpdate:modelValue"])]),s("td",K,p(f(a.quantity*a.unit_price)),1),s("td",X,[e(c,{icon:"mdi-delete",variant:"text",color:"error",size:"small",onClick:u=>S(q),disabled:i(l).items.length<=1},null,8,["onClick","disabled"])])]))),128))])]),_:1}),e(y,null,{default:o(()=>[e(r,{cols:"12",md:"7"},{default:o(()=>[e(O,{modelValue:i(l).notes,"onUpdate:modelValue":t[7]||(t[7]=a=>i(l).notes=a),label:"Notes",variant:"outlined",rows:"4"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",md:"5"},{default:o(()=>[e(C,{variant:"outlined",class:"pa-4 bg-grey-lighten-4"},{default:o(()=>[s("div",Y,[t[12]||(t[12]=s("span",null,"Subtotal:",-1)),s("span",Z,p(f(V.value)),1)]),s("div",ee,[t[13]||(t[13]=s("span",null,"Tax (10%):",-1)),s("span",te,p(f(h.value)),1)]),e(g,{class:"my-2"}),s("div",le,[t[14]||(t[14]=s("span",null,"Total:",-1)),s("span",se,p(f(D.value)),1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(g),e(P,{class:"pa-6"},{default:o(()=>[e(L),e(c,{variant:"text",onClick:t[8]||(t[8]=a=>n.$window.history.back()),class:"mr-2"},{default:o(()=>[...t[15]||(t[15]=[x(" Cancel ",-1)])]),_:1}),e(c,{color:"primary",type:"submit",size:"large",loading:i(l).processing},{default:o(()=>[...t[16]||(t[16]=[x(" Update Invoice ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{re as default};
