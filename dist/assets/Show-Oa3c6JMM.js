import{o as d,M as v,b as e,u as z,T as K,a,k as Q,m as S,h as s,N as $,i as r,U as f,f as i,R as n,Y as F,c as p,aj as M,q as P,s as w,Z as b,O as k,a7 as h,aa as A,n as g,ab as j,p as x,ac as B,ad as I,ae as N,v as R,ao as W,an as E,a2 as O,S as X,a8 as V,r as T}from"./app-CqcLQhWc.js";import{_}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-SEMuvBU0.js";import"./LoaderWrapper-CNYIpUw8.js";import"./LogoMain.vue_vue_type_script_setup_true_lang-BnGuLdGC.js";import"./useApi-o-nPpLEi-7nyp_4n4.js";const tt={class:"d-flex align-center"},et={class:"text-h3 font-weight-bold"},at={class:"d-flex align-center text-subtitle-1 text-medium-emphasis"},lt={class:"d-flex gap-1"},st={class:"text-body-1",style:{"white-space":"pre-wrap"}},it={class:"d-flex justify-space-between"},ot={class:"text-caption"},nt={class:"text-caption"},dt={class:"d-flex justify-space-between"},rt={class:"text-caption"},ut={class:"mb-4"},ct={key:0,class:"text-body-2"},ft={key:1,class:"text-body-2"},mt={class:"mb-4"},vt={key:0,class:"d-flex align-center"},kt={class:"text-caption text-white"},gt={class:"text-body-2"},xt={key:1,class:"text-body-2"},Ct={class:"mb-4"},yt={key:0,class:"d-flex align-center"},pt={class:"text-caption text-white"},wt={class:"text-body-2"},bt={class:"mb-0"},Vt={class:"text-body-2"},$t={__name:"Show",props:{ticket:Object},setup(l){const m=l,U=T(!1),C=T(!1),y=T(!1),D=T(!1),u=T(!1),q=()=>{confirm("Are you sure you want to delete this ticket?")&&V.delete(route("crm.tickets.destroy",m.ticket.id))},L=c=>{U.value=!0,V.put(route("crm.tickets.update",m.ticket.id),{...m.ticket,status:c},{onFinish:()=>U.value=!1})},H=()=>{u.value=!0,V.post(route("crm.tickets.convert-to-lead",m.ticket.id),{},{onFinish:()=>{u.value=!1,C.value=!1}})},Y=()=>{u.value=!0,V.post(route("crm.tickets.convert-to-deal",m.ticket.id),{},{onFinish:()=>{u.value=!1,y.value=!1}})},Z=()=>{u.value=!0,V.post(route("crm.tickets.convert-to-contact",m.ticket.id),{},{onFinish:()=>{u.value=!1,D.value=!1}})},G=c=>{switch(c){case"open":return"primary";case"in_progress":return"info";case"pending":return"warning";case"resolved":return"success";case"closed":return"grey";default:return"grey"}},J=c=>{switch(c){case"low":return"success";case"medium":return"warning";case"high":return"error";case"urgent":return"deep-orange";default:return"grey"}};return(c,t)=>(d(),v(X,null,[e(z(K),{title:"Ticket Details - "+l.ticket.ticket_number},null,8,["title"]),e(_,null,{default:a(()=>[e(Q,null,{default:a(()=>[e(S,{cols:"12",class:"d-flex justify-space-between align-center mb-4"},{default:a(()=>[s("div",tt,[e(z($),{href:c.route("crm.tickets.index"),class:"mr-4"},{default:a(()=>[e(r,{icon:"",variant:"text"},{default:a(()=>[e(f,null,{default:a(()=>[...t[11]||(t[11]=[i("mdi-arrow-left",-1)])]),_:1})]),_:1})]),_:1},8,["href"]),s("div",null,[s("h2",et,n(l.ticket.ticket_number)+": "+n(l.ticket.subject),1),s("div",at,[e(F,{color:G(l.ticket.status),size:"small",variant:"flat",class:"text-capitalize mr-3"},{default:a(()=>[i(n(l.ticket.status.replace("_"," ")),1)]),_:1},8,["color"]),e(F,{color:J(l.ticket.priority),size:"small",variant:"outlined",class:"text-capitalize mr-3"},{default:a(()=>[i(n(l.ticket.priority),1)]),_:1},8,["color"]),e(f,{size:"small",class:"mr-1"},{default:a(()=>[...t[12]||(t[12]=[i("mdi-tag-outline",-1)])]),_:1}),i(" "+n(l.ticket.category),1)])])]),s("div",lt,[l.ticket.status!=="resolved"&&l.ticket.status!=="closed"?(d(),p(M,{key:0},{activator:a(({props:o})=>[e(r,h({variant:"outlined",color:"primary"},o,{title:"Update Status"}),{default:a(()=>[e(f,null,{default:a(()=>[...t[13]||(t[13]=[i("mdi-list-status",-1)])]),_:1})]),_:1},16)]),default:a(()=>[e(P,{size:"small"},{default:a(()=>[l.ticket.status!=="in_progress"?(d(),p(w,{key:0,onClick:t[0]||(t[0]=o=>L("in_progress")),"prepend-icon":"mdi-play-circle-outline"},{default:a(()=>[e(b,null,{default:a(()=>[...t[14]||(t[14]=[i("Mark In Progress",-1)])]),_:1})]),_:1})):k("",!0),l.ticket.status!=="pending"?(d(),p(w,{key:1,onClick:t[1]||(t[1]=o=>L("pending")),"prepend-icon":"mdi-clock-outline"},{default:a(()=>[e(b,null,{default:a(()=>[...t[15]||(t[15]=[i("Mark Pending",-1)])]),_:1})]),_:1})):k("",!0),e(w,{onClick:t[2]||(t[2]=o=>L("resolved")),color:"success","prepend-icon":"mdi-check-circle-outline"},{default:a(()=>[e(b,null,{default:a(()=>[...t[16]||(t[16]=[i("Mark Resolved",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0),l.ticket.status!=="closed"?(d(),p(M,{key:1},{activator:a(({props:o})=>[e(r,h({variant:"outlined",color:"warning"},o,{title:"Convert Ticket"}),{default:a(()=>[e(f,null,{default:a(()=>[...t[17]||(t[17]=[i("mdi-cached",-1)])]),_:1})]),_:1},16)]),default:a(()=>[e(P,{size:"small"},{default:a(()=>[e(w,{onClick:t[3]||(t[3]=o=>C.value=!0),"prepend-icon":"mdi-account-convert"},{default:a(()=>[e(b,null,{default:a(()=>[...t[18]||(t[18]=[i("Convert to Lead",-1)])]),_:1})]),_:1}),e(w,{onClick:t[4]||(t[4]=o=>y.value=!0),"prepend-icon":"mdi-handshake-outline"},{default:a(()=>[e(b,null,{default:a(()=>[...t[19]||(t[19]=[i("Convert to Deal",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0),e(z($),{href:c.route("crm.tickets.edit",l.ticket.id)},{default:a(()=>[e(r,{variant:"outlined",color:"secondary",title:"Edit Ticket"},{default:a(()=>[e(f,null,{default:a(()=>[...t[20]||(t[20]=[i("mdi-pencil",-1)])]),_:1})]),_:1})]),_:1},8,["href"]),e(r,{color:"error",variant:"text",onClick:q,title:"Delete Ticket"},{default:a(()=>[e(f,null,{default:a(()=>[...t[21]||(t[21]=[i("mdi-delete",-1)])]),_:1})]),_:1})])]),_:1}),e(S,{cols:"12",md:"8"},{default:a(()=>[e(A,{modelValue:C.value,"onUpdate:modelValue":t[6]||(t[6]=o=>C.value=o),"max-width":"500"},{default:a(()=>[e(g,null,{default:a(()=>[e(j,{class:"text-h5 pa-4"},{default:a(()=>[...t[22]||(t[22]=[i("Convert Ticket to Lead?",-1)])]),_:1}),e(x,{class:"pa-4"},{default:a(()=>[...t[23]||(t[23]=[i(" This will create a new Lead based on this ticket's information and mark the ticket as closed. ",-1)])]),_:1}),e(B,{class:"pa-4"},{default:a(()=>[e(I),e(r,{variant:"text",onClick:t[5]||(t[5]=o=>C.value=!1)},{default:a(()=>[...t[24]||(t[24]=[i("Cancel",-1)])]),_:1}),e(r,{color:"warning",variant:"flat",onClick:H,loading:u.value},{default:a(()=>[...t[25]||(t[25]=[i("Convert to Lead",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:D.value,"onUpdate:modelValue":t[8]||(t[8]=o=>D.value=o),"max-width":"500"},{default:a(()=>[e(g,null,{default:a(()=>[e(j,{class:"text-h5 pa-4"},{default:a(()=>[...t[26]||(t[26]=[i("Convert Ticket to Contact?",-1)])]),_:1}),e(x,{class:"pa-4"},{default:a(()=>[...t[27]||(t[27]=[i(" This will create a new Contact based on this ticket's information and mark the ticket as closed. ",-1)])]),_:1}),e(B,{class:"pa-4"},{default:a(()=>[e(I),e(r,{variant:"text",onClick:t[7]||(t[7]=o=>D.value=!1)},{default:a(()=>[...t[28]||(t[28]=[i("Cancel",-1)])]),_:1}),e(r,{color:"warning",variant:"flat",onClick:Z,loading:u.value},{default:a(()=>[...t[29]||(t[29]=[i("Convert to Contact",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:y.value,"onUpdate:modelValue":t[10]||(t[10]=o=>y.value=o),"max-width":"500"},{default:a(()=>[e(g,null,{default:a(()=>[e(j,{class:"text-h5 pa-4"},{default:a(()=>[...t[30]||(t[30]=[i("Convert Ticket to Deal?",-1)])]),_:1}),e(x,{class:"pa-4"},{default:a(()=>[...t[31]||(t[31]=[i(" This will create a new Deal for the associated client and mark the ticket as closed. ",-1)])]),_:1}),e(B,{class:"pa-4"},{default:a(()=>[e(I),e(r,{variant:"text",onClick:t[9]||(t[9]=o=>y.value=!1)},{default:a(()=>[...t[32]||(t[32]=[i("Cancel",-1)])]),_:1}),e(r,{color:"warning",variant:"flat",onClick:Y,loading:u.value},{default:a(()=>[...t[33]||(t[33]=[i("Convert to Deal",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(g,{elevation:"0",border:"",class:"mb-6"},{default:a(()=>[e(N,{title:"Description"}),e(R),e(x,{class:"pa-4"},{default:a(()=>[s("div",st,n(l.ticket.description),1)]),_:1})]),_:1}),e(g,{elevation:"0",border:""},{default:a(()=>[e(N,{title:"Ticket History"}),e(R),e(x,{class:"pa-4"},{default:a(()=>[e(W,{density:"compact",align:"start"},{default:a(()=>[e(E,{"dot-color":"primary",size:"x-small"},{default:a(()=>[s("div",it,[s("div",null,[t[34]||(t[34]=s("div",{class:"text-subtitle-2 font-weight-bold"},"Ticket Created",-1)),s("div",ot,"by "+n(l.ticket.reporter?.name||"System"),1)]),s("div",nt,n(new Date(l.ticket.created_at).toLocaleString()),1)])]),_:1}),l.ticket.resolved_at?(d(),p(E,{key:0,"dot-color":"success",size:"x-small"},{default:a(()=>[s("div",dt,[t[35]||(t[35]=s("div",null,[s("div",{class:"text-subtitle-2 font-weight-bold"},"Ticket Resolved")],-1)),s("div",rt,n(new Date(l.ticket.resolved_at).toLocaleString()),1)])]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(S,{cols:"12",md:"4"},{default:a(()=>[e(g,{elevation:"0",border:"",class:"mb-6"},{default:a(()=>[e(N,{title:"Ticket Details"}),e(R),e(x,{class:"pa-4"},{default:a(()=>[s("div",ut,[t[37]||(t[37]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Related Client",-1)),l.ticket.client?(d(),v("div",ct,[e(f,{size:"small",class:"mr-2"},{default:a(()=>[...t[36]||(t[36]=[i("mdi-factory",-1)])]),_:1}),e(z($),{href:c.route("crm.clients.show",l.ticket.client.id),class:"text-decoration-none font-weight-bold"},{default:a(()=>[i(n(l.ticket.client.name),1)]),_:1},8,["href"])])):(d(),v("div",ft,"N/A"))]),s("div",mt,[t[38]||(t[38]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Assigned To",-1)),l.ticket.assignee?(d(),v("div",vt,[e(O,{size:"24",color:"primary",class:"mr-2"},{default:a(()=>[s("span",kt,n(l.ticket.assignee.name.charAt(0)),1)]),_:1}),s("span",gt,n(l.ticket.assignee.name),1)])):(d(),v("div",xt,"Unassigned"))]),s("div",Ct,[t[39]||(t[39]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Reported By",-1)),l.ticket.reporter?(d(),v("div",yt,[e(O,{size:"24",color:"secondary",class:"mr-2"},{default:a(()=>[s("span",pt,n(l.ticket.reporter.name.charAt(0)),1)]),_:1}),s("span",wt,n(l.ticket.reporter.name),1)])):k("",!0)]),s("div",bt,[t[40]||(t[40]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Created",-1)),s("div",Vt,n(new Date(l.ticket.created_at).toLocaleString()),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{$t as default};
